{"id":".claude-07m","title":"Test lint enforcement","description":"Testing that the lint hook fires","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-07T00:02:18.224082-08:00","created_by":"Luan Santos","updated_at":"2026-02-07T00:02:24.092636-08:00","deleted_at":"2026-02-07T00:02:24.092636-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-08g","title":"Revise skills to match Anthropic best practices","description":"## Problem\n20 skills audited against Anthropic's Complete Guide to Building Skills. 2 have broken filenames (invisible to Claude), writing-skills missing key rules, several descriptions lack WHAT+WHEN format, references to nonexistent skills.\n\n## Solution\nTargeted fixes in 6 phases: filename fixes, writing-skills update, broken references, description quality, cleanup, progressive disclosure.\n\n## Success Criteria\n- All SKILL.md files correctly cased\n- writing-skills covers all guide rules\n- No references to nonexistent skills\n- All descriptions follow WHAT + WHEN + triggers format\n- Redundant frontmatter removed, allowed-tools normalized\n- Long skills use references/ for progressive disclosure","status":"closed","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-13T22:15:58.503411-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:34:06.782901-08:00","closed_at":"2026-02-13T22:34:06.782901-08:00","close_reason":"Closed"}
{"id":".claude-08g.1","title":"Fix SKILL.md filename case for pr-description and pr-fix-comments","description":"## Context\nEpic: .claude-08g — Revise skills to match Anthropic best practices\n\n## Files\n- Rename: skills/pr-description/skill.md → SKILL.md\n- Rename: skills/pr-fix-comments/skill.md → SKILL.md\n\n## Acceptance Criteria\n- [ ] Both files renamed to SKILL.md (exact case)\n- [ ] Git tracks the rename correctly\n- [ ] Skills are discoverable after rename\n\n## Implementation\n\n### Step 1: Rename pr-description\ngit mv skills/pr-description/skill.md skills/pr-description/SKILL.tmp\ngit mv skills/pr-description/SKILL.tmp skills/pr-description/SKILL.md\n\n### Step 2: Rename pr-fix-comments\ngit mv skills/pr-fix-comments/skill.md skills/pr-fix-comments/SKILL.tmp\ngit mv skills/pr-fix-comments/SKILL.tmp skills/pr-fix-comments/SKILL.md\n\n### Step 3: Verify\nls -la skills/pr-description/SKILL.md skills/pr-fix-comments/SKILL.md\ngit status — should show renamed files","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:16:22.443738-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:25:57.347747-08:00","closed_at":"2026-02-13T22:25:57.347747-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-08g.1","depends_on_id":".claude-08g","type":"parent-child","created_at":"2026-02-13T22:16:22.444439-08:00","created_by":"Luan Santos"}]}
{"id":".claude-08g.2","title":"Update writing-skills with missing Anthropic guide rules","description":"## Context\nEpic: .claude-08g — Revise skills to match Anthropic best practices\n\n## Files\n- Modify: skills/writing-skills/SKILL.md\n\n## Acceptance Criteria\n- [ ] Covers no claude/anthropic naming restriction\n- [ ] Covers no XML in frontmatter restriction\n- [ ] Covers no README.md in skill folder rule\n- [ ] Covers \u003c1024 char description limit\n- [ ] Description guidance updated to WHAT + WHEN (not ONLY triggers)\n- [ ] Standard dirs (references/, assets/) documented\n- [ ] Progressive disclosure 3-level model mentioned\n- [ ] Existing TDD methodology preserved unchanged\n\n## Implementation\n\n### Edit 1: Add naming + frontmatter restrictions to Frontmatter section\nAfter the frontmatter code block (line 61 closing ```), before the field table:\n\nold_string:\n```\n| Field | Effect |\n|-------|--------|\n| `disable-model-invocation: true` | User-only |\n| `user-invocable: false` | Claude-only |\n| `context: fork` | Isolated subagent |\n```\n\nnew_string:\n```\n**Restrictions:**\n- Name must NOT contain \"claude\" or \"anthropic\"\n- No XML tags in frontmatter values\n- Description must be \u003c1024 characters\n\n| Field | Effect |\n|-------|--------|\n| `disable-model-invocation: true` | User-only |\n| `user-invocable: false` | Claude-only |\n| `context: fork` | Isolated subagent |\n```\n\n### Edit 2: Add references/ and assets/ to directory structure, add README.md prohibition\nold_string:\n```\nskills/\n  skill-name/\n    SKILL.md              # Main reference (required)\n    template.md           # Template\n    examples/             # Example outputs\n    scripts/              # Utilities\n```\n\nnew_string:\n```\nskills/\n  skill-name/\n    SKILL.md              # Main reference (required)\n    template.md           # Template\n    examples/             # Example outputs\n    references/           # Heavy reference material\n    assets/               # Static assets\n    scripts/              # Utilities\n```\n\nNote: Never add README.md to skill folders — SKILL.md is the entry point.\n\n### Edit 3: Update description guidance from \"ONLY triggers\" to \"WHAT + WHEN\"\nold_string:\n```\n## Description Field (Critical)\n\n**ONLY triggers. NEVER workflow summary.**\n\n```yaml\n# BAD: Claude shortcuts instead of reading skill\ndescription: Use when executing plans - dispatches subagent per task with review\n\n# GOOD: Just triggers\ndescription: Use when executing implementation plans with independent tasks\n```\n\n**Why:** Claude shortcuts workflow summaries, skips actual content.\n```\n\nnew_string:\n```\n## Description Field (Critical)\n\n**WHAT it does + WHEN to use. NEVER workflow details.**\n\nMust be \u003c1024 characters. Tells Claude what the skill does and when to\ninvoke it — but not HOW it works internally.\n\n```yaml\n# BAD: workflow details Claude will shortcut\ndescription: Use when executing plans - dispatches subagent per task with review\n\n# GOOD: what + when\ndescription: Use when executing implementation plans with independent tasks\n```\n\n**Why:** Claude shortcuts workflow summaries, skips actual content.\n```\n\n### Edit 4: Add progressive disclosure guidance to SKILL.md Structure section\nold_string:\n```\n## Common Mistakes\nWhat fails + fixes.\n```\n```\n\nnew_string:\n```\n## Common Mistakes\nWhat fails + fixes.\n```\n\n**Progressive disclosure:** Structure content in 3 levels:\n1. **Critical** — must-know rules (## Critical header)\n2. **Important** — common patterns (## Important header)\n3. **Reference** — lookup tables, edge cases\n\nUse `## Critical` / `## Important` headers so Claude prioritizes\ncorrectly under token pressure.\n```","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:17:06.799833-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:27:25.29519-08:00","closed_at":"2026-02-13T22:27:25.29519-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-08g.2","depends_on_id":".claude-08g","type":"parent-child","created_at":"2026-02-13T22:17:06.800482-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08g.2","depends_on_id":".claude-08g.1","type":"blocks","created_at":"2026-02-13T22:20:33.422199-08:00","created_by":"Luan Santos"}]}
{"id":".claude-08g.3","title":"Remove references to nonexistent skills in debugging and implement","description":"## Context\nEpic: .claude-08g — Revise skills to match Anthropic best practices\n\n## Files\n- Modify: skills/debugging/SKILL.md\n- Modify: skills/implement/SKILL.md\n\n## Acceptance Criteria\n- [ ] No references to nonexistent skills remain\n- [ ] Behavior preserved (inlined or removed gracefully)\n- [ ] No broken skill dispatch calls\n\n## Implementation\n\n### 1. debugging/SKILL.md — Remove `team-debug` references\n\n**Replace line 33** (Phase 3, step 2):\n```\nold: 2. **If you identify 3+ plausible hypotheses:** STOP — invoke `Skill tool: team-debug` with bug description + hypotheses. Don't continue single-thread debugging.\nnew: 2. **If you identify 3+ plausible hypotheses:** STOP — spawn parallel subagents (one per hypothesis) to investigate simultaneously. Each subagent traces one hypothesis, reports evidence for/against.\n```\n\n**Replace line 36** (Phase 3, step 5 parenthetical):\n```\nold: 5. Worked → Phase 4. Didn't → NEW hypothesis (if this is your 3rd hypothesis, escalate per step 2)\nnew: 5. Worked → Phase 4. Didn't → NEW hypothesis (if this is your 3rd hypothesis, parallelize per step 2)\n```\n\n**Replace line 40** (Phase 4, step 1):\n```\nold: 1. Create failing test - use Skill tool to invoke `tdd`\nnew: 1. Create failing test that reproduces the bug\n```\n\n**Replace lines 58-65** (Skill Composition table — remove entirely, all three entries reference nonexistent skills):\n```\nold:\n## Skill Composition\n\n| When | Invoke |\n|------|--------|\n| Writing tests | `use Skill tool to invoke tdd` |\n| Verifying fix | `use Skill tool to invoke verification-before-completion` |\n| 3+ plausible root causes | `use Skill tool to invoke team-debug` |\n\nnew: (delete entirely — behavior is now inlined in phases above)\n```\n\n### 2. implement/SKILL.md — Remove `finishing-branch` references\n\n**Replace line 61** (Solo Mode, step 6):\n```\nold: 6. Done → invoke finishing-branch skill\nnew: 6. Done → `bd sync` + report completion to caller\n```\n\n**Replace line 140** (Swarm Teardown, step 3):\n```\nold: 3. Invoke finishing-branch skill\nnew: 3. `bd sync` + report completion to caller\n```","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:17:42.795232-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:28:27.53936-08:00","closed_at":"2026-02-13T22:28:27.53936-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-08g.3","depends_on_id":".claude-08g","type":"parent-child","created_at":"2026-02-13T22:17:42.795873-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08g.3","depends_on_id":".claude-08g.1","type":"blocks","created_at":"2026-02-13T22:20:33.501579-08:00","created_by":"Luan Santos"}]}
{"id":".claude-08g.4","title":"Improve description quality for 5 skills","description":"## Context\nEpic: .claude-08g — Revise skills to match Anthropic best practices\n\n## Files\n- Modify: skills/compress-prompt/SKILL.md (description only)\n- Modify: skills/git-surgeon/SKILL.md (description only)\n- Modify: skills/graphite/SKILL.md (description only)\n- Modify: skills/reference-sync/SKILL.md (description only)\n- Modify: skills/implement/SKILL.md (description only)\n\n## Acceptance Criteria\n- [ ] All 5 descriptions follow WHAT + WHEN + triggers format\n- [ ] All under 1024 chars\n- [ ] No XML tags\n- [ ] No workflow summaries in descriptions\n\n## Implementation\n\n### 1. compress-prompt/SKILL.md\n\n**Old:**\n```\ndescription: Use when compressing text for AI consumption - skill files, system prompts, agent instructions. Not for human docs.\n```\n\n**New:**\n```\ndescription: Compress text for AI consumption — skill files, system prompts, agent instructions. Triggers: \"compress\", \"reduce tokens\", \"shrink prompt\", \"make it shorter for AI\". Not for human docs.\n```\n\n### 2. git-surgeon/SKILL.md\n\n**Old:**\n```\ndescription: Non-interactive hunk-level git staging, unstaging, discarding, undoing, fixup, and commit splitting. Use when selectively staging, unstaging, discarding, reverting, or splitting individual diff hunks by ID instead of interactively. Also use when asked to commit changes separately, make separate commits, or split changes into multiple commits.\n```\n\n**New:**\n```\ndescription: Non-interactive hunk-level git operations — stage, unstage, discard, undo, fixup, and split by hunk ID. Triggers: \"stage this hunk\", \"split commit\", \"partial stage\", \"discard hunk\", \"selective staging\", \"commit separately\", \"separate commits\".\n```\n\n### 3. graphite/SKILL.md\n\n**Old:**\n```\ndescription: Graphite stacked PRs - create, sync, modify, submit. Auto-triggers on gt commands, \"stack\", \"branch\", \"PR\", \"push\", \"submit\".\n```\n\n**New:**\n```\ndescription: Manage Graphite stacked PRs — create, sync, modify, submit branches and PRs. Triggers: gt commands, \"stack\", \"branch\", \"PR\", \"push\", \"submit\".\n```\n\n### 4. reference-sync/SKILL.md\n\n**Old:**\n```\ndescription: \"Sync references/ submodule and analyze changes since last update\"\n```\n\n**New:**\n```\ndescription: \"Sync references/ submodule and analyze upstream changes since last update. Triggers: \\\"reference sync\\\", \\\"check references\\\", \\\"update references\\\", \\\"what changed upstream\\\".\"\n```\n\n### 5. implement/SKILL.md\n\n**Old:**\n```\ndescription: \"Triggers: 'invoke implement', 'implement with arg', beads issue/epic ID, 'execute the plan', 'build this', 'code this plan', 'start implementing', 'now implement', 'time to implement', 'ready to implement', 'begin implementation', 'let me implement', 'To continue: use Skill tool to invoke implement'. Extract issue-id from 'with arg X'.\"\n```\n\n**New:**\n```\ndescription: \"Execute a beads epic or task — auto-detects solo vs swarm mode, dispatches subagents to implement. Triggers: \\\"implement\\\", \\\"execute the plan\\\", \\\"build this\\\", \\\"code this plan\\\", \\\"start implementing\\\", \\\"ready to implement\\\", beads issue/epic ID.\"\n```","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:18:24.732311-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:29:31.11354-08:00","closed_at":"2026-02-13T22:29:31.11354-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-08g.4","depends_on_id":".claude-08g","type":"parent-child","created_at":"2026-02-13T22:18:24.733234-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08g.4","depends_on_id":".claude-08g.2","type":"blocks","created_at":"2026-02-13T22:20:33.57947-08:00","created_by":"Luan Santos"}]}
{"id":".claude-08g.5","title":"Normalize frontmatter and add error handling across skills","description":"## Context\nEpic: .claude-08g — Revise skills to match Anthropic best practices\n\n## Files\n- Modify: skills/pr-fix-gha/SKILL.md (remove redundant frontmatter)\n- Modify: skills/fix/SKILL.md (fix step numbering)\n- Modify: skills/pr-description/SKILL.md (normalize allowed-tools syntax)\n- Modify: skills/graphite/SKILL.md (normalize allowed-tools syntax)\n- Modify: skills/start/SKILL.md (add error handling)\n- Modify: skills/fix/SKILL.md (add error handling)\n- Modify: skills/reference-sync/SKILL.md (add error handling)\n- Modify: skills/prepare/SKILL.md (add error handling)\n\n## Acceptance Criteria\n- [ ] No redundant frontmatter fields (remove `disable-model-invocation: false` from pr-fix-gha)\n- [ ] Step numbering correct in fix skill (1, 2, 3 not 1, 3, 4)\n- [ ] Consistent allowed-tools wildcard syntax: `Bash(cmd:*)` with colon (dominant pattern)\n- [ ] Basic error handling notes in start, fix, reference-sync, prepare\n\n## Implementation\n\n### 1. pr-fix-gha/SKILL.md — Remove redundant frontmatter\nDelete line 5: `disable-model-invocation: false` (false is the default)\n\n### 2. fix/SKILL.md — Fix step numbering\n- Line 35: change `3.` to `2.`\n- Line 42: change `4.` to `3.`\n\n### 3. Normalize allowed-tools wildcard syntax to `Bash(cmd:*)`\nFiles using space syntax that need colon:\n- **pr-description/SKILL.md**: change all `Bash(cmd *)` to `Bash(cmd:*)`\n  - `Bash(git status *)` → `Bash(git status:*)`\n  - `Bash(git diff *)` → `Bash(git diff:*)`\n  - `Bash(git log *)` → `Bash(git log:*)`\n  - `Bash(git branch *)` → `Bash(git branch:*)`\n  - `Bash(git show *)` → `Bash(git show:*)`\n  - `Bash(gh pr view *)` → `Bash(gh pr view:*)`\n  - `Bash(gh pr edit *)` → `Bash(gh pr edit:*)`\n  - `Bash(gt log *)` → `Bash(gt log:*)`\n- **graphite/SKILL.md**: `Bash(gt *)` already uses space — change to `Bash(gt:*)`\n\n### 4. Add error handling to start/SKILL.md\nAfter step 6, add:\n```\n## Error Handling\n- `gt create` fails → check if branch exists (`git branch -a | grep \u003cname\u003e`), suggest alternate name\n- `bd update` fails → verify issue ID exists with `bd show \u003cid\u003e`, report if missing\n- Not on expected parent branch → warn user, suggest `gt checkout` first\n```\n\n### 5. Add error handling to fix/SKILL.md\nAfter step 3 (Report), add:\n```\n## Error Handling\n- No beads CLI → tell user to install, stop\n- `bd create` fails → show error, retry once, then report\n- Ambiguous feedback → AskUserQuestion for clarification before creating issues\n```\n\n### 6. Add error handling to reference-sync/SKILL.md\nAfter Key Constraints section, add:\n```\n## Error Handling\n- No `references/` directory → \"Submodule not initialized. Run: `git submodule update --init`\"\n- `git fetch` fails → check network, report and stop\n- Subagent fails on area → report which area failed, continue with others\n```\n\n### 7. Add error handling to prepare/SKILL.md\nAfter step 8 (Report), add:\n```\n## Error Handling\n- No design field content → \"Run `/explore` first to generate a design\", stop\n- `bd create` fails for epic → check beads CLI available, report error\n- Subagent fails on phase → report which phase, continue others, note gap in report\n- `bd swarm validate` fails → show validation errors, ask user how to proceed\n```","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:19:17.648847-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:31:12.267456-08:00","closed_at":"2026-02-13T22:31:12.267456-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-08g.5","depends_on_id":".claude-08g","type":"parent-child","created_at":"2026-02-13T22:19:17.649847-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08g.5","depends_on_id":".claude-08g.1","type":"blocks","created_at":"2026-02-13T22:20:33.659694-08:00","created_by":"Luan Santos"}]}
{"id":".claude-08g.6","title":"Move detailed content to references/ for review and pr-reviewers","description":"## Context\nEpic: .claude-08g — Revise skills to match Anthropic best practices\n\nTwo skills exceed ideal length. Move detailed reference content to\nreferences/ subdirectories following 3-level progressive disclosure:\nfrontmatter (always loaded) → SKILL.md body (on invoke) → linked files\n(navigated on demand).\n\n## Files\n- Modify: skills/review/SKILL.md (trim from 201 → ~110 lines)\n- Create: skills/review/references/prompts.md (reviewer prompt templates)\n- Modify: skills/pr-reviewers/SKILL.md (trim from 111 → ~70 lines)\n- Create: skills/pr-reviewers/references/scoring.md (scoring algorithm)\n\n## review/SKILL.md — What Moves\n\nMove lines 67–102 (Solo Mode lens prompts) and lines 112–146\n(Perspective Mode prompts) and lines 171–185 (fix dispatch prompt)\nto `references/prompts.md`.\n\nReplace each block with a single instruction line:\n```\nRead references/prompts.md for \u003csection\u003e prompt templates.\n```\n\nKeep: mode selection logic, step structure, consolidation rules,\noutput format, receiving feedback section.\n\n### references/prompts.md content\n\n```markdown\n# Reviewer Prompt Templates\n\n## Solo Mode\n\n### Lens 1: Correctness \u0026 Security\n\\`\\`\\`\nYou are an adversarial correctness and security reviewer.\n\n{diff + full file contents}\n\nFocus:\n- Edge cases (empty, null, overflow, concurrent access)\n- Invalid states, race conditions\n- Resource leaks (unclosed handles, missing cleanup)\n- Silent failures, swallowed errors\n- Off-by-one, logic inversions\n- Injection (SQL, command, XSS, template)\n- Auth/authz gaps, data exposure, cryptographic misuse\n\nOutput: table with Severity | File:Line | Issue | Suggestion\nThen brief summary.\n\\`\\`\\`\n\n### Lens 2: Architecture \u0026 Performance\n\\`\\`\\`\nYou are an adversarial architecture and performance reviewer.\n\n{diff + full file contents}\n\nFocus:\n- Incomplete refactors, dead code, unused params\n- Unnecessary abstractions, coupling\n- Could this be simpler?\n- O(n^2) in loops, unnecessary allocations\n- Memory (retained refs, unbounded growth)\n- I/O (blocking calls, N+1 queries)\n- Concurrency (thread safety, deadlock, contention)\n\nOutput: table with Severity | File:Line | Issue | Suggestion\nThen brief summary.\n\\`\\`\\`\n\n## Perspective Mode (--team)\n\n### Perspective 1: Architect (model: opus)\n\\`\\`\\`\nArchitecture reviewer. Focus:\n- System boundaries, coupling, scalability\n- Design flaws, incomplete abstractions\n- Dependency direction, module cohesion\n- Could this be simpler or more maintainable?\n\nTag: [architect]\nOutput: Phase 1 (Critical) → Phase 2 (Design) → Phase 3 (Testing Gaps)\n\\`\\`\\`\n\n### Perspective 2: Code Quality (model: sonnet)\n\\`\\`\\`\nCode quality reviewer. Focus:\n- Readability, naming, error handling\n- Edge cases, off-by-one, null safety\n- Consistency with surrounding code\n- Resource leaks, missing cleanup\n\nTag: [code-quality]\nOutput: Phase 1 (Critical) → Phase 2 (Design) → Phase 3 (Testing Gaps)\n\\`\\`\\`\n\n### Perspective 3: Devil's Advocate (model: opus)\n\\`\\`\\`\nDevil's advocate reviewer. Focus:\n- Failure modes others miss\n- Security: injection, auth gaps, data exposure\n- Bad assumptions, race conditions\n- What breaks under load, bad input, or partial failure?\n\nTag: [devil]\nOutput: Phase 1 (Critical) → Phase 2 (Design) → Phase 3 (Testing Gaps)\n\\`\\`\\`\n\n## Fix Dispatch Prompt (model: sonnet)\n\\`\\`\\`\nFix these review issues in code.\n\n## Issues to Fix\n{issues with file:line refs}\n\n## Your Job\n1. Fix each listed issue\n2. Verify fixes (syntax check, tests if quick)\n3. Report what you fixed\n\nDo NOT: fix unlisted things, refactor beyond needed, add features\n\\`\\`\\`\n```\n\n## pr-reviewers/SKILL.md — What Moves\n\nMove lines 46–75 (candidate gathering git commands) and lines 79–96\n(scoring weights + penalties tables) to `references/scoring.md`.\n\nReplace with:\n```\nRead references/scoring.md for candidate gathering commands, scoring\nweights, and penalty multipliers.\n```\n\nKeep: steps overview, generated file exclusion list, presentation\nrules, \"never say reviewed your PRs\" rule.\n\n### references/scoring.md content\n\n```markdown\n# Scoring Algorithm\n\n## Candidate Gathering Commands\n\n**For existing files** — use `git log` not `git blame` (faster):\n\\`\\`\\`\ngit log --since=\"12 months ago\" --format='%aN \u003c%aE\u003e' --diff-filter=M -- \u003cfiles\u003e | sort | uniq -c | sort -rn\n\\`\\`\\`\n\n**For new files** — find experts on parent directory:\n\\`\\`\\`\ngit log --since=\"12 months ago\" --format='%aN \u003c%aE\u003e' -- \u003cparent_dirs\u003e | sort | uniq -c | sort -rn\n\\`\\`\\`\n\n**Line-weighted ownership** (for top candidates only, not all files):\n\\`\\`\\`\ngit log --since=\"12 months ago\" --numstat --format='%aN' -- \u003cfiles\u003e\n\\`\\`\\`\nSum lines touched per author. Normalize: `author_lines / total_lines`.\n\n**Recent reviewers** (for PENALTY):\n\\`\\`\\`\ngh pr list --author @me --state merged --limit 10 --json reviews\n\\`\\`\\`\n\n**Current review load**:\n\\`\\`\\`\ngh api graphql -f query='{ search(query:\"is:pr is:open review-requested:\u003cusername\u003e\", type:ISSUE) { issueCount } }'\n\\`\\`\\`\n\n**CODEOWNERS**: check `.github/CODEOWNERS` or `CODEOWNERS`.\nSkip if absent — don't error.\n\n## Scoring Weights\n\n| Factor | Weight | Normalization |\n|--------|--------|---------------|\n| Line-weighted ownership | 40% | `author_lines / total_lines` across changed files |\n| Recent commit count | 30% | `author_commits / max_commits` among candidates |\n| CODEOWNERS match | 15% | 1.0 if matched, 0.0 if not (skip if no file) |\n| Directory familiarity (new files) | 15% | `dir_commits / max_dir_commits` |\n\n## Penalties (multiply final score)\n\n| Condition | Multiplier |\n|-----------|------------|\n| Reviewed 3+ of last 5 author PRs | ×0.7 |\n| Reviewed 2 of last 5 author PRs | ×0.85 |\n| 5+ open review requests | ×0.8 |\n| 8+ open review requests | ×0.6 |\n```\n\n## Acceptance Criteria\n- [ ] review/SKILL.md under 120 lines with references/ link\n- [ ] review/references/prompts.md contains all prompt templates verbatim\n- [ ] pr-reviewers/SKILL.md under 80 lines with references/ link\n- [ ] pr-reviewers/references/scoring.md contains scoring algorithm verbatim\n- [ ] Skills still function correctly (orchestration logic intact in SKILL.md)\n- [ ] No content lost — moved content preserved exactly","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:20:20.306866-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:33:29.568773-08:00","closed_at":"2026-02-13T22:33:29.568773-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-08g.6","depends_on_id":".claude-08g","type":"parent-child","created_at":"2026-02-13T22:20:20.307725-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08g.6","depends_on_id":".claude-08g.1","type":"blocks","created_at":"2026-02-13T22:20:33.739094-08:00","created_by":"Luan Santos"}]}
{"id":".claude-08z","title":"Model tiering: optimize subagent model selection","description":"All subagent dispatches inherit Opus. Agent .md files lack proper YAML frontmatter. Skills dispatch general-purpose everywhere. Add model tiering (opus/sonnet/haiku) to agents and skills.\n\n## Success Criteria\n- All 6 agents have proper YAML frontmatter with name, description, model, tools\n- commit skill runs on haiku, compress-prompt on sonnet\n- feedback and review fix dispatches use sonnet\n- Review lenses merged from 4 to 2\n- rules/model-tiering.md documents the policy\n- /agents command shows all agents with correct config","status":"closed","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-09T19:48:35.473311-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:55:04.710707-08:00","closed_at":"2026-02-09T19:55:04.710707-08:00","close_reason":"All 7 child tasks completed","dependencies":[{"issue_id":".claude-08z","depends_on_id":".claude-0o9","type":"blocks","created_at":"2026-02-09T19:51:46.013044-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08z","depends_on_id":".claude-78w","type":"blocks","created_at":"2026-02-09T19:51:46.108307-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08z","depends_on_id":".claude-kgh","type":"blocks","created_at":"2026-02-09T19:51:46.19712-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08z","depends_on_id":".claude-ktm","type":"blocks","created_at":"2026-02-09T19:51:46.273322-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08z","depends_on_id":".claude-0hp","type":"blocks","created_at":"2026-02-09T19:51:46.366263-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08z","depends_on_id":".claude-hyl","type":"blocks","created_at":"2026-02-09T19:51:46.466612-08:00","created_by":"Luan Santos"},{"issue_id":".claude-08z","depends_on_id":".claude-uxd","type":"blocks","created_at":"2026-02-09T19:51:46.550711-08:00","created_by":"Luan Santos"}]}
{"id":".claude-0hp","title":"Merge review lenses 4→2 and add sonnet fix dispatch","description":"Two changes in review/SKILL.md:\n\n## Change 1: Merge Step 3 lenses (4→2)\n\nReplace 4 lens prompts with 2 merged lenses:\n\nLens 1: Correctness \u0026 Security — merge Lens 2 + Lens 3. Combined: edge cases, invalid states, race conditions, resource leaks, injection, auth gaps, data exposure, secrets, crypto misuse.\n\nLens 2: Architecture \u0026 Performance — merge Lens 1 + Lens 4. Combined: incomplete refactors, abstractions, dead code, coupling, simplicity, algorithmic complexity, memory, I/O, concurrency.\n\nUpdate Step 3 intro from 'Spawn 4' to 'Spawn 2'.\nUpdate Step 4 to reference 2 reviewers.\n\n## Change 2: Step 5 fix agent → sonnet\n\nold_string:\n```\nSpawn general-purpose agent with:\n```\n\nnew_string:\n```\nSpawn general-purpose agent (model: \"sonnet\") with:\n```\n\n## Acceptance Criteria\n- Step 3 has exactly 2 lens prompts (not 4)\n- Step 5 dispatch includes model: sonnet\n- All original review focus areas covered across the 2 lenses","status":"closed","priority":1,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:49:07.455898-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:54:09.128113-08:00","closed_at":"2026-02-09T19:54:09.128113-08:00","close_reason":"Closed"}
{"id":".claude-0o9","title":"Add YAML frontmatter to all 6 agent definitions","description":"Add required YAML frontmatter (name, description, model, tools) to all agents in ~/.claude/agents/.\n\n## Agent Config\n\n| Agent | model | tools |\n|-------|-------|-------|\n| implementer | sonnet | Read, Edit, Write, Bash, Glob, Grep |\n| researcher | haiku | Read, Glob, Grep |\n| reviewer | sonnet | Read, Glob, Grep, Bash |\n| tester | sonnet | Read, Edit, Write, Bash, Glob, Grep |\n| architect | inherit | Read, Glob, Grep, Bash |\n| devil | inherit | Read, Glob, Grep |\n\n## Example (implementer.md)\n\n```yaml\n---\nname: implementer\ndescription: Follows plans precisely. Writes minimal code to satisfy requirements. No scope creep. Use for mechanical code changes from explicit instructions.\nmodel: sonnet\ntools: Read, Edit, Write, Bash, Glob, Grep\n---\n```\n\nKeep existing markdown body unchanged. Just prepend frontmatter.\n\n## Files\n- ~/.claude/agents/implementer.md\n- ~/.claude/agents/researcher.md\n- ~/.claude/agents/reviewer.md\n- ~/.claude/agents/tester.md\n- ~/.claude/agents/architect.md\n- ~/.claude/agents/devil.md\n\n## Acceptance Criteria\n- All 6 agents have valid YAML frontmatter with name, description, model, tools\n- Existing markdown body unchanged\n- model values match table above","status":"closed","priority":1,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:48:52.203299-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:52:49.278019-08:00","closed_at":"2026-02-09T19:52:49.278019-08:00","close_reason":"Closed"}
{"id":".claude-5tg","title":"Eliminate parallel commit races in swarm mode","description":"## Problem\nSwarm workers commit directly via merge-slot (implement/SKILL.md:133), causing deadlocks when workers die, hook races on intermediate states, and --no-verify workarounds.\n\n## Solution\nWorkers edit files only. Orchestrator commits after each wave. Eliminates merge-slot entirely — no deadlocks, no hook races, hooks run once per wave on final state.\n\n## Success Criteria\n- [ ] Workers prohibited from git add/commit in rules and skill prompts\n- [ ] Implement skill: merge-slot removed, orchestrator commits per wave\n- [ ] Commit skill guarded against team/background contexts\n- [ ] Session-completion scoped to main thread","status":"closed","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-14T11:26:05.353123-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:10:11.932916-08:00","closed_at":"2026-02-14T12:10:11.932916-08:00","close_reason":"Closed"}
{"id":".claude-5tg.1","title":"Add git prohibition rules to worker-discipline.md","description":"## Context\nEpic: .claude-5tg\nPhase: 1/4 - Add prohibition rules\n\n## Goal\nAdd explicit \"workers never git add/commit\" rule to worker-discipline.md. Workers focus on edits + build gate only; all git operations are orchestrator-only.\n\n## Files\n- Read: /Users/luan/.claude/rules/worker-discipline.md (why: understand current structure and sections)\n- Modify: /Users/luan/.claude/rules/worker-discipline.md (why: add new \"## Git Operations\" section)\n\n## Approach\n1. Add new \"## Git Operations\" section after \"## Fix Methodology\" (after line 14)\n2. Content: \"Workers NEVER run git commands (add, commit, push, etc). Git operations are orchestrator-only. Workers: file edits + build gate. That's it.\"\n3. Keep tone consistent with existing sections (direct, imperative)\n4. Use existing formatting pattern (## header, bullet/prose as needed)\n\n## Acceptance Criteria\n- [ ] New \"## Git Operations\" section exists in worker-discipline.md\n- [ ] Section placed after \"## Fix Methodology\"\n- [ ] Message is clear: workers never touch git\n- [ ] Formatting matches existing style\n- [ ] No regressions\n\n## Assumptions\n- File has standard markdown structure with ## headers\n- Current sections end at line 14 (Fix Methodology) and 19 (Scope Limits)\n- Two-line spacing between sections","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:26:38.760958-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:30:49.678331-08:00","closed_at":"2026-02-14T11:30:49.678331-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.1","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:26:38.761666-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.2","title":"Add git prohibition to CLAUDE.md Subagent Rules","description":"## Context\nEpic: .claude-5tg\nPhase: 1/4 - Add prohibition rules\n\n## Goal\nAdd explicit \"workers never git add/commit\" bullet to CLAUDE.md Subagent Rules section. Complement worker-discipline.md with user-facing rule.\n\n## Files\n- Read: /Users/luan/.claude/CLAUDE.md (why: understand Subagent Rules section structure)\n- Modify: /Users/luan/.claude/CLAUDE.md (why: add git prohibition bullet)\n\n## Approach\n1. Add new bullet to \"## Subagent Rules\" section (starts at line 70)\n2. Insert after \"**Claim atomically:**\" bullet (line 72)\n3. Content: \"**Git operations:** Workers never run git commands. Orchestrator commits.\"\n4. Match existing bold-label pattern (**Label:** content)\n5. Keep consistent tone with other bullets (directive, concise)\n\n## Acceptance Criteria\n- [ ] New bullet exists in Subagent Rules section of CLAUDE.md\n- [ ] Bullet placed after \"Claim atomically\" and before \"File ownership\"\n- [ ] Format matches existing pattern (bold label + colon + rule)\n- [ ] Message is clear: workers don't touch git, orchestrator does\n- [ ] No regressions\n\n## Assumptions\n- Subagent Rules section has consistent bullet formatting\n- Section currently has 6 bullets (lines 71-76)\n- Each bullet starts with bold label","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:26:51.039824-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:31:05.674541-08:00","closed_at":"2026-02-14T11:31:05.674541-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.2","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:26:51.040634-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.3","title":"Remove merge-slot and git ops from swarm workers in implement skill","description":"## Context\nEpic: .claude-5tg\nPhase: 2/4 - Modify implement skill (swarm mode)\n\n## Goal\nRemove merge-slot creation from swarm setup and git add/commit from worker loop. Workers no longer commit; orchestrator will commit after wave completion.\n\n## Files\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (why: understand swarm setup and worker loop structure)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md (why: remove merge-slot + git operations)\n\n## Approach\n1. Remove `bd merge-slot create` from Swarm Setup section (line 90)\n2. Remove step 8 from worker loop prompt: \"bd merge-slot acquire → git add/commit → release\" (line 133)\n3. Renumber subsequent steps (9-10 become 8-9)\n4. Keep other worker steps intact (build gate, bd close, etc.)\n5. Preserve swarm setup structure minus merge-slot\n\n## Acceptance Criteria\n- [ ] Line 90 \"bd merge-slot create\" removed from Setup section\n- [ ] Step 8 (merge-slot + git operations) removed from worker loop\n- [ ] Steps 9-10 renumbered to 8-9\n- [ ] No merge-slot references remain in worker instructions\n- [ ] All other worker steps preserved\n- [ ] No regressions\n\n## Assumptions\n- Swarm Setup starts at line 84\n- Worker loop prompt starts at line 116\n- Step 8 is currently the only git-related step in worker loop\n- Steps 9-10 (bd close + loop back) remain unchanged except numbering","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:27:07.002935-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:31:54.402549-08:00","closed_at":"2026-02-14T11:31:54.402549-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.3","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:27:07.003559-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.3","depends_on_id":".claude-5tg.1","type":"blocks","created_at":"2026-02-14T11:29:01.285154-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.3","depends_on_id":".claude-5tg.2","type":"blocks","created_at":"2026-02-14T11:29:01.349108-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.4","title":"Add orchestrator commit step after swarm wave completion","description":"## Context\nEpic: .claude-5tg\nPhase: 2/4 - Modify implement skill (swarm mode)\n\n## Goal\nAdd orchestrator commit step after \"Wait for all workers to complete\" in swarm wave loop. Orchestrator now commits after each wave instead of workers committing individually.\n\n## Files\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (why: understand wave loop structure and placement point)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md (why: add orchestrator commit step)\n\n## Approach\n1. Insert new step after line 148 (\"Wait for all workers to complete\")\n2. Before the escalation check line (line 149)\n3. Content: \"Commit wave changes: `git add -u \u0026\u0026 git commit -m 'feat: implement wave \u003cn\u003e (\u003cbrief-summary\u003e)'`\"\n4. Use inline code formatting to match existing style\n5. Keep brief: just the commit command + context\n\n## Acceptance Criteria\n- [ ] New commit step added after \"Wait for all workers to complete\"\n- [ ] Step placed before escalation/progress check\n- [ ] Uses conventional commit format (feat: ...)\n- [ ] Staging command includes -u flag (tracked files only)\n- [ ] Formatting matches surrounding text style\n- [ ] No regressions\n\n## Assumptions\n- Line 148 is \"Wait for all workers to complete\" within wave loop\n- Line 149 starts escalation/progress reporting logic\n- Orchestrator has write access to git (it created branch)\n- Workers have already closed tasks before this step","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:27:21.555654-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:32:18.859494-08:00","closed_at":"2026-02-14T11:32:18.859494-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.4","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:27:21.560123-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.4","depends_on_id":".claude-5tg.3","type":"blocks","created_at":"2026-02-14T11:29:01.411327-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.5","title":"Add no-commit instruction to solo worker prompt","description":"## Context\nEpic: .claude-5tg\nPhase: 2/4 - Modify implement skill (solo mode)\n\n## Goal\nAdd explicit \"never git add/commit\" instruction to solo worker prompt. Solo workers should focus on edits + build gate only; orchestrator commits.\n\n## Files\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (why: understand solo worker prompt structure)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md (why: add no-commit instruction)\n\n## Approach\n1. Find solo worker dispatch prompt (starts around line 52)\n2. Add instruction after \"Completion gate\" section (after line 68)\n3. Before the `bd close \u003ctask-id\u003e` step (line 70)\n4. Content: \"**Never run git commands.** Orchestrator handles commits. You: edits + build gate only.\"\n5. Use bold pattern to match existing emphasis (like \"Step 0 — Understand\")\n6. Keep concise and directive\n\n## Acceptance Criteria\n- [ ] New no-commit instruction exists in solo worker prompt\n- [ ] Placed after completion gate, before bd close step\n- [ ] Uses bold for emphasis matching existing style\n- [ ] Message is clear: workers never touch git\n- [ ] Formatting matches surrounding instructions\n- [ ] No regressions\n\n## Assumptions\n- Solo mode dispatch starts at line 49\n- Completion gate section ends at line 68\n- bd close step is at line 70\n- Solo prompt structure mirrors swarm worker rules","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:27:34.981024-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:32:43.953783-08:00","closed_at":"2026-02-14T11:32:43.953783-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.5","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:27:34.981733-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.5","depends_on_id":".claude-5tg.4","type":"blocks","created_at":"2026-02-14T11:29:01.473993-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.6","title":"Add orchestrator commit step after solo worker completion","description":"## Context\nEpic: .claude-5tg\nPhase: 2/4 - Modify implement skill (solo mode)\n\n## Goal\nAdd orchestrator commit step after solo worker returns (before continuation prompt). Orchestrator commits solo work just like swarm waves.\n\n## Files\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (why: understand solo mode flow and continuation prompt location)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md (why: add orchestrator commit step)\n\n## Approach\n1. Find end of solo mode section (after step 7 \"See Continuation Prompt below\", line 80)\n2. Insert new instruction before the continuation prompt section reference\n3. Content: \"Commit all changes: `git add -u \u0026\u0026 git commit -m 'feat: implement \u003cepic-title\u003e (\u003cid\u003e)'`\"\n4. Use inline code formatting for command\n5. Keep brief and directive\n\n## Acceptance Criteria\n- [ ] New commit step added after solo worker returns\n- [ ] Step placed before \"→ See Continuation Prompt below\"\n- [ ] Uses conventional commit format with epic context\n- [ ] Staging uses -u flag (tracked files only)\n- [ ] Formatting matches solo mode instruction style\n- [ ] No regressions\n\n## Assumptions\n- Solo mode ends at line 80 with continuation prompt reference\n- Continuation prompt section starts at line 169\n- Solo worker has already run `bd sync` at step 6\n- Orchestrator has git write access (created branch in step 3)","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:27:48.166081-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:33:08.363072-08:00","closed_at":"2026-02-14T11:33:08.363072-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.6","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:27:48.166702-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.6","depends_on_id":".claude-5tg.5","type":"blocks","created_at":"2026-02-14T11:29:01.53548-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.7","title":"Add foreground-only context guard to commit skill","description":"## Context\nEpic: .claude-5tg\nPhase: 3/4 - Guard commit skill\n\n## Goal\nAdd note at top of commit skill Steps section clarifying this is main-thread/foreground only. Workers should never invoke this skill.\n\n## Files\n- Read: /Users/luan/.claude/skills/commit/SKILL.md (why: understand structure and Steps section location)\n- Modify: /Users/luan/.claude/skills/commit/SKILL.md (why: add context guard)\n\n## Approach\n1. Add note immediately before \"## Steps\" section (before line 32)\n2. Content: \"**Context:** Main thread / foreground only. Workers never commit.\"\n3. Use bold \"Context:\" label pattern (matches skill conventions)\n4. Keep single line, direct\n5. Place after \"## Context\" section (which shows git status)\n\n## Acceptance Criteria\n- [ ] New context guard exists before \"## Steps\" section\n- [ ] Uses bold \"Context:\" label\n- [ ] Message is clear: main thread only, workers excluded\n- [ ] Formatting matches existing skill structure\n- [ ] Placed logically after status context, before steps\n- [ ] No regressions\n\n## Assumptions\n- Steps section starts at line 32\n- Context section (with git status) ends around line 30\n- Skill is only invoked from main thread currently\n- Workers have no commit tool access (enforced elsewhere)","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:28:01.519238-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:33:31.574522-08:00","closed_at":"2026-02-14T11:33:31.574522-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.7","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:28:01.519873-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.7","depends_on_id":".claude-5tg.6","type":"blocks","created_at":"2026-02-14T11:29:01.595789-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.8","title":"Add main-thread qualifier to session-completion commit step","description":"## Context\nEpic: .claude-5tg\nPhase: 4/4 - Clarify session-completion\n\n## Goal\nAdd \"(main thread only)\" qualifier to step 5 (commit code changes) in session-completion.md. Workers should not run session completion; orchestrators handle it.\n\n## Files\n- Read: /Users/luan/.claude/rules/session-completion.md (why: understand structure and step 5 location)\n- Modify: /Users/luan/.claude/rules/session-completion.md (why: add main-thread qualifier)\n\n## Approach\n1. Modify step 5 (line 9): \"Commit code changes if uncommitted\"\n2. Add qualifier: \"Commit code changes if uncommitted (main thread only)\"\n3. Keep parenthetical format to minimize disruption\n4. Other steps remain unchanged (apply to both workers and orchestrators)\n5. Preserve numbered list formatting\n\n## Acceptance Criteria\n- [ ] Step 5 includes \"(main thread only)\" qualifier\n- [ ] Qualifier placed at end of step description\n- [ ] Parenthetical format matches style conventions\n- [ ] Other steps (1-4) unchanged\n- [ ] Numbered list formatting preserved\n- [ ] No regressions\n\n## Assumptions\n- Step 5 is currently line 9\n- File has 5 numbered steps\n- Steps 1-4 apply to all agents (filing work, quality gates, status updates, sync)\n- Only step 5 (commit) is orchestrator-specific","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:28:14.526457-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:33:54.630477-08:00","closed_at":"2026-02-14T11:33:54.630477-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.8","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:28:14.527066-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.8","depends_on_id":".claude-5tg.7","type":"blocks","created_at":"2026-02-14T11:29:01.657004-08:00","created_by":"Luan Santos"}]}
{"id":".claude-5tg.9","title":"Add build-fail coordination rule for parallel workers","description":"## Context\nEpic: .claude-5tg\nPhase: Cross-cutting — addresses worker behavior when builds fail due to other workers' changes\n\n## Goal\nWorkers must NOT close tasks claiming \"pre-existing failure\" when tests/build fail due to another parallel worker's incomplete changes. Instead they coordinate with the team lead and wait until things stabilize before resuming.\n\nCurrent failure mode observed: worker closes task saying \"test failure is in unrelated container test (pre-existing)\" when actually another parallel worker caused the failure with partial refactoring. Worker should have paused and coordinated.\n\n## Files\n- Read: /Users/luan/.claude/rules/worker-discipline.md (why: understand current build gate rules)\n- Modify: /Users/luan/.claude/rules/worker-discipline.md (why: add foreign-failure coordination rule to build gate)\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (why: understand worker prompt build gate section)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md (why: add coordination instruction to swarm worker build gate)\n\n## Approach\n1. In worker-discipline.md Build Gate section, add rule: \"Build/test failure from another worker's changes → DO NOT close task, DO NOT label as pre-existing. Message team lead with failure details, wait for coordination.\"\n2. In implement/SKILL.md swarm worker prompt step 7 (build gate), add: \"If failure traces to another worker's file → message team lead, wait. Do NOT close task or dismiss as pre-existing.\"\n3. Keep the \"your failure → fix it\" path unchanged\n4. This is about embracing parallel instability as normal, not avoiding it\n\n## Acceptance Criteria\n- [ ] worker-discipline.md build gate distinguishes \"your failure\" vs \"foreign failure\"\n- [ ] Foreign failure path: message lead, wait (not close, not skip)\n- [ ] implement/SKILL.md worker prompt includes same distinction\n- [ ] Workers cannot close tasks when build fails due to other workers\n- [ ] No regressions to existing build gate (own failures still max 3 attempts)\n\n## Assumptions\n- worker-discipline.md Build Gate is at lines 6-11\n- implement/SKILL.md swarm worker build gate is step 7 (lines 128-131)\n- Team lead is reachable via SendMessage\n- Workers can identify foreign failures by checking which files the error traces to vs their file ownership","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T11:29:26.400217-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:34:22.686575-08:00","closed_at":"2026-02-14T11:34:22.686575-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-5tg.9","depends_on_id":".claude-5tg","type":"parent-child","created_at":"2026-02-14T11:29:26.400933-08:00","created_by":"Luan Santos"},{"issue_id":".claude-5tg.9","depends_on_id":".claude-5tg.6","type":"blocks","created_at":"2026-02-14T11:29:30.379302-08:00","created_by":"Luan Santos"}]}
{"id":".claude-6kl","title":"Explore: commit workflow produces unsplittable commits and branch sprawl","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Current State\n\n### Commit Problem\nImplement commits at wrong granularity — Solo: 1 commit for all tasks (line 81), Swarm: 1 per wave (line 153). Both use \\`git add .\\`. Always needs /split-commit afterward.\n\nUser wants: single WIP commit from implement, then /split-commit for vertical commits.\n\n### Branch Sprawl Problem\nEvery \\`/implement\\` unconditionally runs \\`gt create\\` (Solo line 56, Swarm line 93). Over N sessions = N unwanted branches. No cleanup anywhere.\n\n## Recommendation\n\n1. **Implement never creates branches.** Remove \\`gt create\\` entirely. Work on current branch (could be main, could be feature branch from /start). Branch creation is /start's job, not implement's.\n2. **Single WIP commit.** Replace per-wave/per-completion commits with one \\`wip: implement \u003cepic-title\u003e (\u003cid\u003e)\\` commit.\n3. **Stale branch detection** in resume-work.\n\n## Key Files\n\nModify:\n- \\`skills/implement/SKILL.md\\` — remove \\`gt create\\`, single WIP commit, update flow\n- \\`skills/resume-work/SKILL.md\\` — stale branch detection\n- \\`rules/session-completion.md\\` — branch housekeeping suggestion\n- \\`CLAUDE.md\\` — update flow: implement → split-commit → review → refine → commit\n\n## Risks\n\n- WIP commit + split-commit dependency: user must split-commit after implement. Mitigation: continuation prompt suggests /split-commit.\n- Swarm workers reference \"Branch: luan/\u003cdescription\u003e (already created)\" in prompt. Update to reference current branch dynamically.\n\n## Next Steps\n\n**Phase 1: Remove branch creation from implement**\nFiles: skills/implement/SKILL.md\nApproach: Delete \\`gt create\\` from Solo (line 56) and Swarm (line 93-94). Swarm worker context (line 149) should reference current branch dynamically instead of hardcoded \"already created\" note.\n1. Solo Mode: delete line 56 (\\`gt create luan/\u003cshort-description\u003e\\`)\n2. Swarm Mode: delete line 93 (\\`gt create luan/\u003cshort-description\u003e\\`)\n3. Swarm worker context line 149: change from \"Branch: luan/\u003cdescription\u003e (already created)\" to dynamically reference current branch\n4. Update key rules section\n\n**Phase 2: Single WIP commit in implement**\nFiles: skills/implement/SKILL.md\nApproach: Replace Solo commit (line 81) and Swarm per-wave commits (line 153) with single WIP commit after all work. Update continuation prompt.\n1. Solo: replace line 81 with single commit after all tasks: \\`git add . \u0026\u0026 git commit -m 'wip: implement \u003cepic-title\u003e (\u003cid\u003e)'\\`\n2. Swarm: remove per-wave commits (line 153). Add single WIP commit in Teardown after all waves.\n3. Continuation prompt: replace \"Continue to /review\" with \"Continue to /split-commit\" as recommended, then /review after that\n4. Update CLAUDE.md flow: explore → prepare → implement → split-commit → review → refine → commit\n\n**Phase 3: Stale branch detection in resume-work**\nFiles: skills/resume-work/SKILL.md\nApproach: Cross-reference local branches with beads status after gathering context.\n1. Add step: list local luan/* branches, check against \\`bd list --status in_progress\\`\n2. Stale branches (no matching in-progress beads) → add to summary as suggestion\n3. Never auto-delete\n\n**Phase 4: Session completion branch housekeeping**\nFiles: rules/session-completion.md\nApproach: Add non-blocking branch awareness.\n1. Add step: \"Note stale branches for cleanup\"\n2. Suggestion only, not mandatory","status":"in_progress","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T12:10:01.132849-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:36:35.422782-08:00"}
{"id":".claude-78w","title":"Add model: haiku to commit skill frontmatter","description":"Add model: haiku to commit/SKILL.md YAML frontmatter.\n\n## Edit\n\nFile: ~/.claude/skills/commit/SKILL.md\n\nold_string:\n```\ncontext: fork\nagent: general-purpose\n```\n\nnew_string:\n```\ncontext: fork\nagent: general-purpose\nmodel: haiku\n```\n\n## Acceptance Criteria\n- model: haiku present in commit/SKILL.md frontmatter\n- Rest of file unchanged","status":"closed","priority":1,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:48:55.260863-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:53:21.618515-08:00","closed_at":"2026-02-09T19:53:21.618515-08:00","close_reason":"Closed"}
{"id":".claude-7fv","title":"Explore: pr-fix-comments skill for dot-claude repo","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Current State\n\n**Deleted from dot-claude** in commit 0b0a142 (Feb 11) as \"superseded skills\".\n\n**Upstream version** (repo-local):\n- Uses `uv run` + custom arg parsing library\n- Hardcoded repo name\n- Uses `git push` (breaks Graphite)\n- Missing `gt` from allowed-tools\n- Combines \"commit, push, resolve\" into one step\n\n**Old dot-claude version** (deleted):\n- Used `python3` + standard `argparse`\n- Repo-agnostic (auto-detected via `gh repo view`)\n- Used `gt ss --update-only` correctly\n\n## Recommendation\n\nNew skill in `~/.claude/skills/pr-fix-comments/` that:\n1. Repo-agnostic script (auto-detect via `gh repo view`)\n2. Standard python3 + argparse (no external deps)\n3. Two-phase confirmation: commit (ask) → push separately (ask)\n4. Uses `gt ss --update-only` not `git push`\n5. Never auto-pushes\n\n## Key Files\n\nCreate:\n- `~/.claude/skills/pr-fix-comments/skill.md`\n- `~/.claude/skills/pr-fix-comments/scripts/pr_threads.py`\n\n## Risks\n\n- `gh repo view` fails without git remote\n- `gt ss` fails if stack has conflicts\n- Thread resolution on draft PRs may differ\n\n## Next Steps\n\n**Phase 1: Skill prompt** (`skill.md`)\n**Phase 2: Script** (`pr_threads.py`)\n**Phase 3: Validate**","status":"closed","priority":2,"issue_type":"task","owner":"luan@thebrowser.company","created_at":"2026-02-13T11:13:49.632418-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T11:43:08.502715-08:00","closed_at":"2026-02-13T11:23:31.022359-08:00"}
{"id":".claude-a5d","title":"Explore: Redesign skill pipeline flow and prepare simplification","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Pipeline Redesign v2: After Studying Latest Reference Skills\n\n### Key Discovery: Their prepare is LIGHTWEIGHT\nOne subagent creates all tasks as thin design briefs — NO implementation code, NO test code. Workers implement from scratch.\n\n### Revised Phases\n\n**Phase 1: Rewrite prepare — one sonnet subagent, design briefs not code**\nFiles: skills/prepare/SKILL.md\n- Replace N opus subagents with ONE sonnet subagent for all tasks\n- Thin task template: Goal/Files/Approach/Criteria/Assumptions (no code)\n- Add bd swarm create after validate\n- Close source bead after success\n\n**Phase 2: Adapt implement for design briefs**\nFiles: skills/implement/SKILL.md\n- Remove \"Copy EXACTLY\" from solo + swarm prompts\n- Change pre-flight: \"tasks lack criteria or file paths → STOP\"\n- Workers: investigate → TDD from brief → build gate\n\n**Phase 3: Review/refine reorder + flow docs**\nFiles: skills/refine/SKILL.md, skills/review/SKILL.md, CLAUDE.md, rules/model-tiering.md\n- Refine pre-condition: after clean review\n- CLAUDE.md flow line update\n- model-tiering: prepare nested model opus → sonnet\n\n**Phase 4: Fix consolidation**\nFiles: skills/fix/SKILL.md\n- One bead with phased design field instead of N separate beads\n- Directly consumable by /prepare","notes":"## Session State\n\n### Completed\n1. Epic .claude-08g (merged to main): Revised all 20 skills against Anthropic best practices guide\n   - Fixed 2 broken SKILL.md filenames\n   - Updated writing-skills with guide rules\n   - Removed broken skill references\n   - Description quality pass on 5 skills\n   - Normalized frontmatter, added error handling\n   - Progressive disclosure for review/pr-reviewers\n\n2. Epic .claude-jdi (merged to main): Hardened skills against insights friction points\n   - Worker prompts: investigation-first, indentation pre-flight, build gates, scope limits\n   - rules/worker-discipline.md created (confirmed subagents inherit rules)\n   - retry-limits extended with worker caps\n   - prepare: assumptions section requirement\n   - implement: orchestrator scope control\n\n3. Epic .claude-e56 (on luan/pipeline-redesign, NOT merged): Pipeline redesign\n   - prepare: one subagent, design briefs not code\n   - implement: workers own TDD, no more \"copy EXACTLY\"\n   - review/refine reorder: review → refine → commit\n   - fix: one bead with phases\n\n4. Model tiering updated (on luan/pipeline-redesign): opus default for ambiguity\n5. README.md rewritten (on luan/pipeline-redesign)\n\n### Pending\n- luan/pipeline-redesign branch needs merge to main\n- Reference submodule updated but not committed (pointing to latest upstream)","status":"closed","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-13T23:27:36.043995-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:46:46.939503-08:00","closed_at":"2026-02-14T08:43:21.064538-08:00","close_reason":"Closed"}
{"id":".claude-bb7","title":"Auto-chain pipeline skills with --auto flag","description":"## Problem\nPipeline skills run independently with no flow. User manually copy-pastes IDs between steps. Skills also don't surface ambiguity well enough.\n\n## Solution\n1. Each pipeline skill asks context-aware continuation questions at the end (AskUserQuestion)\n2. Skills interview the user better during execution when facing genuine ambiguity\n3. Add Skill to allowed-tools where missing (prepare, refine) to enable chaining\n\n## Success Criteria\n- Pipeline skills offer intelligent continuation after completion\n- Continuation options reflect actual outcome (not generic Y/N)\n- Skills ask better questions during execution when ambiguous\n- User can enter at any point and chain forward naturally","status":"closed","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-14T08:57:45.876972-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:47:57.149222-08:00","closed_at":"2026-02-14T09:47:57.149222-08:00","close_reason":"All children completed"}
{"id":".claude-bb7.1","title":"Add --auto chaining to explore skill","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nAdd --auto flag parsing and chaining logic to explore skill. When --auto is set and exploration completes successfully, automatically invoke /prepare \u003cbead-id\u003e --auto to continue the pipeline.\n\n## Files\n- Read: ~/.claude/skills/explore/SKILL.md (understand current argument parsing, output structure, and skill dispatch flow)\n- Modify: ~/.claude/skills/explore/SKILL.md (add --auto flag parsing, add Skill tool invocation after successful completion)\n\n## Approach\n1. Add --auto to argument-hint in frontmatter (currently \"\u003cprompt\u003e [--continue]\" → \"\u003cprompt\u003e [--continue] [--auto]\")\n2. Parse --auto flag in Instructions section (extract from $ARGUMENTS)\n3. After step 6 (output summary), add conditional: if --auto flag set, invoke Skill tool with skill=\"prepare\", args=\"\u003cbead-id\u003e --auto\"\n4. Skill tool is already in allowed-tools (line 8), no frontmatter change needed\n5. Preserve existing --continue flag behavior\n6. Chain triggers only on successful completion (after findings stored in design field)\n\n## Acceptance Criteria\n- [ ] --auto flag parsed from $ARGUMENTS\n- [ ] After successful exploration, if --auto: invokes /prepare \u003cbead-id\u003e --auto\n- [ ] --continue flag behavior unchanged\n- [ ] Skill tool invocation includes bead ID extracted from created/continued bead\n- [ ] No regressions\n\n## Assumptions\n- Skill tool already available in allowed-tools (verified line 8)\n- Bead ID is available after step 1 (create bead) or step 1 in continuation flow (resolve issue ID)\n- Chaining should happen after step 6 (output summary), not after step 5 (store findings)","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:58:30.047503-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.174212-08:00","deleted_at":"2026-02-14T09:16:19.174212-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.10","title":"Add continuation prompt to prepare","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nAfter prepare outputs epic summary, add AskUserQuestion with continuation options. If user picks continue, invoke Skill tool to trigger implement.\n\n## Files\n- Read: /Users/luan/.claude/skills/prepare/SKILL.md (understand current flow)\n- Modify: /Users/luan/.claude/skills/prepare/SKILL.md (add continuation prompt after step 8)\n\n## Approach\nAdd after step 8 \"Report\":\n\n```markdown\n9. **Continuation prompt:**\n   Use AskUserQuestion with options:\n   - \"Continue to /implement \u003cepic-id\u003e\" (recommended)\n   - \"Review tasks first\"\n   - \"Done for now\"\n   \n   If user selects \"Continue to /implement\":\n   - Invoke Skill tool: skill=\"implement\", args=\"\u003cepic-id\u003e\"\n```\n\n## Acceptance Criteria\n- [ ] Step 9 added after \"Report\" section\n- [ ] AskUserQuestion has all 3 options with \"continue\" marked recommended\n- [ ] Skill invocation uses epic-id from step 4\n- [ ] No changes to error handling section\n\n## Assumptions\n- prepare will have Skill in allowed-tools (task .claude-bb7.8 completes first)\n- Epic ID is available from step 4's bd create output","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:09:00.295535-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:14:06.251351-08:00","closed_at":"2026-02-14T09:14:06.251351-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.10","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:09:00.296153-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.10","depends_on_id":".claude-bb7.8","type":"blocks","created_at":"2026-02-14T09:09:05.173622-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bb7.11","title":"Add continuation prompt to implement","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nAfter implement completes all tasks, add AskUserQuestion with continuation options. If user picks continue, invoke Skill tool to trigger review.\n\n## Files\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (understand both solo and swarm teardown)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md (add continuation prompts to both modes)\n\n## Approach\nAdd continuation prompt at end of both modes:\n\n**Solo Mode**: After step 6 \"Done → bd sync + report completion\"\n**Swarm Mode**: After teardown step 3 \"bd sync + report completion\"\n\n```markdown\n7. **Continuation prompt:**\n   Use AskUserQuestion with options:\n   - \"Continue to /review\" (recommended)\n   - \"Review changes manually first\"\n   - \"Done for now\"\n   \n   If user selects \"Continue to /review\":\n   - Invoke Skill tool: skill=\"review\", args=\"\" (no args needed, reviews current changes)\n```\n\n## Acceptance Criteria\n- [ ] Continuation prompt added to Solo Mode after step 6\n- [ ] Continuation prompt added to Swarm Mode Teardown after step 3\n- [ ] Both prompts identical with \"review\" as recommended option\n- [ ] Skill invocation for review has no args (uses git diff HEAD by default)\n\n## Assumptions\n- implement already has Skill in allowed-tools\n- review skill accepts no args to review current uncommitted changes\n- Both solo and swarm modes need same continuation pattern","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:09:14.704838-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:13:16.044546-08:00","closed_at":"2026-02-14T09:13:16.044546-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.11","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:09:14.705503-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bb7.12","title":"Add continuation prompt to review","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nAdd context-aware continuation prompt to review based on outcome: clean review vs issues found+fixed vs issues found+not fixed. Invoke next skill accordingly.\n\n## Files\n- Read: /Users/luan/.claude/skills/review/SKILL.md (understand fix workflow and outcomes)\n- Modify: /Users/luan/.claude/skills/review/SKILL.md (replace step 4 AskUserQuestion with context-aware continuation)\n\n## Approach\nReplace existing AskUserQuestion in step 4 (after consolidate + present, before \"Step 4b: Store Findings\") with context-aware prompt:\n\n```markdown\n**Determine outcome context:**\n- Clean review (no findings) → options: \"Continue to /refine\" (recommended), \"Skip to /commit\", \"Done for now\"\n- Issues found and all fixed (Step 5 completed) → options: \"Re-review to verify fixes\" (recommended), \"Continue to /refine\", \"Done for now\"\n- Issues found but not fixed (Step 5 skipped) → options: \"Fix issues\" (recommended), \"Continue anyway to /refine\", \"Done for now\"\n\nUse AskUserQuestion with appropriate options based on context.\n\n**Skill invocations:**\n- \"Continue to /refine\" → Skill tool: skill=\"refine\", args=\"\"\n- \"Skip to /commit\" → Skill tool: skill=\"commit\", args=\"\"\n- \"Re-review to verify fixes\" → re-run from Step 3\n- \"Fix issues\" → proceed to Step 5\n```\n\nReplace existing non-interactive condition: `!$([ \"$CLAUDE_NON_INTERACTIVE\" = \"1\" ] \u0026\u0026 echo \"...\" || echo \"Use AskUserQuestion: ...\")`\n\n## Acceptance Criteria\n- [ ] Step 4 has context-aware continuation logic\n- [ ] Three outcome contexts handled: clean, fixed, not-fixed\n- [ ] Each context has appropriate recommended option\n- [ ] Skill invocations for refine and commit included\n- [ ] Non-interactive echo removed (replaced with direct AskUserQuestion)\n- [ ] Re-review loops back to Step 3, fix proceeds to Step 5\n\n## Assumptions\n- review already has Skill in allowed-tools\n- refine and commit accept no args for default behavior\n- Step 5 (dispatch fixes) and Step 6 (re-review) remain unchanged","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:09:33.466945-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:13:25.982036-08:00","closed_at":"2026-02-14T09:13:25.982036-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.12","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:09:33.467571-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bb7.13","title":"Add continuation prompt to refine","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nAfter refine completes polish, add AskUserQuestion with continuation options. If user picks continue, invoke Skill tool to trigger commit.\n\n## Files\n- Read: /Users/luan/.claude/skills/refine/SKILL.md (understand current flow)\n- Modify: /Users/luan/.claude/skills/refine/SKILL.md (add continuation prompt after step 5)\n\n## Approach\nAdd after step 5 \"Summary\":\n\n```markdown\n## Step 6: Continuation Prompt\n\nUse AskUserQuestion with options:\n- \"Continue to /commit\" (recommended)\n- \"Review changes first\"\n- \"Done for now\"\n\nIf user selects \"Continue to /commit\":\n- Invoke Skill tool: skill=\"commit\", args=\"\"\n```\n\n## Acceptance Criteria\n- [ ] Step 6 added after \"Summary\" section\n- [ ] AskUserQuestion has all 3 options with \"commit\" marked recommended\n- [ ] Skill invocation for commit has no args\n- [ ] \"Skill Composition\" section remains (documents when to refine)\n\n## Assumptions\n- refine will have Skill in allowed-tools (task .claude-bb7.8 completes first)\n- commit skill accepts no args to commit all changes","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:09:45.095778-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:14:07.094865-08:00","closed_at":"2026-02-14T09:14:07.094865-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.13","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:09:45.096368-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.13","depends_on_id":".claude-bb7.8","type":"blocks","created_at":"2026-02-14T09:09:48.701926-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bb7.14","title":"Improve mid-skill interviewing across pipeline","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nAdd guidance to all 6 pipeline skills for when to use AskUserQuestion during execution (not just at end) to surface genuine ambiguity to the user.\n\n## Files\n- Read: /Users/luan/.claude/skills/explore/SKILL.md (current structure)\n- Read: /Users/luan/.claude/skills/prepare/SKILL.md (current structure)\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (current structure)\n- Read: /Users/luan/.claude/skills/review/SKILL.md (current structure)\n- Read: /Users/luan/.claude/skills/refine/SKILL.md (current structure)\n- Read: /Users/luan/.claude/skills/commit/SKILL.md (current structure)\n- Modify: All 6 skill files (add mid-skill interviewing guidance)\n\n## Approach\nFor each skill, add a \"Mid-Skill Interviewing\" section near the top (after Context, before main instructions):\n\n**explore**: \n- Multiple viable approaches with unclear tradeoffs → ask direction\n- Domain ambiguity (business logic interpretation) → clarify with user\n\n**prepare**:\n- Unclear task boundaries (should X and Y be one task or two?) → ask splitting preference\n- Dependency ambiguity (can tasks run parallel or must serialize?) → confirm\n\n**implement**:\n- Design decisions not specified in brief → surface to user before implementing\n- Test strategy unclear (integration vs unit) → ask approach\n\n**review**:\n- Severity judgment borderline (medium vs high) → ask user's priority\n- Pattern violation unclear (style vs correctness) → clarify importance\n\n**refine**:\n- Uncertain if comment adds value (borderline case) → ask if should keep\n- Simplification might change semantics → confirm intent\n\n**commit**:\n- Multiple unrelated changes without clear primary purpose → ask scope preference\n- Type ambiguous (feat vs refactor) → confirm categorization\n\n## Acceptance Criteria\n- [ ] All 6 skills have \"Mid-Skill Interviewing\" section\n- [ ] Each section has 2-3 concrete examples of when to use AskUserQuestion\n- [ ] Examples are skill-specific (not generic)\n- [ ] Section placed consistently (after Context, before main instructions)\n- [ ] Emphasis on genuine ambiguity, not decision avoidance\n\n## Assumptions\n- All 6 skills already have AskUserQuestion in allowed-tools\n- This adds to continuation prompts (tasks 2-6), doesn't replace them\n- Guidance is prescriptive but not exhaustive","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:10:07.5197-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:15:47.739075-08:00","closed_at":"2026-02-14T09:15:47.739075-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.14","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:10:07.520319-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.14","depends_on_id":".claude-bb7.9","type":"blocks","created_at":"2026-02-14T09:10:12.381216-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.14","depends_on_id":".claude-bb7.10","type":"blocks","created_at":"2026-02-14T09:10:12.434835-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.14","depends_on_id":".claude-bb7.11","type":"blocks","created_at":"2026-02-14T09:10:12.488181-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.14","depends_on_id":".claude-bb7.12","type":"blocks","created_at":"2026-02-14T09:10:12.542635-08:00","created_by":"Luan Santos"},{"issue_id":".claude-bb7.14","depends_on_id":".claude-bb7.13","type":"blocks","created_at":"2026-02-14T09:10:12.59955-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bb7.2","title":"Add Skill tool + --auto chaining to prepare skill","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nAdd Skill tool to allowed-tools and implement --auto flag parsing and chaining logic to prepare skill. When --auto is set and task creation completes successfully, automatically invoke /implement \u003cepic-id\u003e --auto to continue the pipeline.\n\n## Files\n- Read: ~/.claude/skills/prepare/SKILL.md (understand current argument parsing, epic creation flow, and completion output)\n- Modify: ~/.claude/skills/prepare/SKILL.md (add Skill to allowed-tools, add --auto flag parsing, add Skill tool invocation after successful completion)\n\n## Approach\n1. Add Skill to allowed-tools in frontmatter (currently has Task, Bash, Read, Glob, Grep, AskUserQuestion)\n2. Add --auto to argument-hint in frontmatter (currently \"[beads-issue-id]\" → \"[beads-issue-id] [--auto]\")\n3. Parse --auto flag from $ARGUMENTS in Steps section (before step 1)\n4. After step 8 (Report), add conditional: if --auto flag set, invoke Skill tool with skill=\"implement\", args=\"\u003cepic-id\u003e --auto\"\n5. Epic ID is available after step 4 (create epic)\n6. Chain triggers only on successful validation (after \"bd swarm validate\" succeeds in step 7)\n\n## Acceptance Criteria\n- [ ] Skill tool added to allowed-tools frontmatter\n- [ ] --auto flag parsed from $ARGUMENTS\n- [ ] After successful preparation, if --auto: invokes /implement \u003cepic-id\u003e --auto\n- [ ] Epic ID correctly extracted from step 4 output\n- [ ] Chaining skipped if validation fails in step 7\n- [ ] No regressions\n\n## Assumptions\n- Skill tool not currently in allowed-tools (verified: only Task, Bash, Read, Glob, Grep, AskUserQuestion)\n- Epic ID is captured during step 4 (bd create for epic)\n- Validation success is determinable from \"bd swarm validate\" exit code or output","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:58:44.279658-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.224169-08:00","deleted_at":"2026-02-14T09:16:19.224169-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.3","title":"Add --auto chaining to implement skill","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nAdd --auto flag parsing and chaining logic to implement skill. When --auto is set and implementation completes successfully, automatically invoke /review --auto to continue the pipeline.\n\n## Files\n- Read: ~/.claude/skills/implement/SKILL.md (understand current argument parsing, completion detection in both solo and swarm modes, and teardown flow)\n- Modify: ~/.claude/skills/implement/SKILL.md (add --auto flag parsing, add Skill tool invocation after successful completion in both modes)\n\n## Approach\n1. Add --auto to argument-hint in frontmatter (currently \"[epic-id|task-id] [--solo]\" → \"[epic-id|task-id] [--solo] [--auto]\")\n2. Parse --auto flag from $ARGUMENTS in Step 1 (Classify Work)\n3. For Solo Mode: after step 6 (report completion to caller), add conditional: if --auto, invoke Skill tool with skill=\"review\", args=\"--auto\"\n4. For Swarm Mode: after Teardown step 3 (report completion to caller), add conditional: if --auto, invoke Skill tool with skill=\"review\", args=\"--auto\"\n5. Skill tool is already in allowed-tools (line 8), no frontmatter change needed\n6. Chain triggers only on successful completion (after \"bd sync\" in both modes)\n7. Pass --auto flag through to subagent dispatch prompts so they know to chain (add to Job section for both solo and swarm worker prompts)\n\n## Acceptance Criteria\n- [ ] --auto flag parsed from $ARGUMENTS\n- [ ] After successful solo implementation, if --auto: invokes /review --auto\n- [ ] After successful swarm implementation, if --auto: invokes /review --auto\n- [ ] --auto flag preserved in subagent dispatch (included in Job sections)\n- [ ] Chaining skipped if implementation fails or is incomplete\n- [ ] --solo flag behavior unchanged\n- [ ] No regressions\n\n## Assumptions\n- Skill tool already available in allowed-tools (verified line 8)\n- Completion is determinable by reaching \"report completion to caller\" in both modes\n- Subagent dispatch prompts are in Job sections (solo: step 4, swarm: Wave Loop worker prompt)","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:59:00.130603-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.270343-08:00","deleted_at":"2026-02-14T09:16:19.270343-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.4","title":"Add --auto chaining to review + non-interactive defaults","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nAdd --auto flag parsing, non-interactive default behavior (auto-fix all findings), and chaining logic to review skill. When --auto is set and review completes with clean results, automatically invoke /refine --auto to continue the pipeline.\n\n## Files\n- Read: ~/.claude/skills/review/SKILL.md (understand current argument parsing, AskUserQuestion usage for severity selection, completion detection, and fix loop flow)\n- Modify: ~/.claude/skills/review/SKILL.md (add --auto flag parsing, add conditional logic to skip AskUserQuestion, add Skill tool invocation after clean review)\n\n## Approach\n1. Add --auto to argument-hint in frontmatter (currently \"[base..head | file-list | PR#] [--against \u003cissue-id\u003e] [--team] [--continue]\" → add [--auto])\n2. Parse --auto flag from $ARGUMENTS in Step 1 (Scope + Mode)\n3. Step 4 currently checks CLAUDE_NON_INTERACTIVE env var for AskUserQuestion. Add additional check: if --auto flag set, skip AskUserQuestion and default to \"Fix all\" severity\n4. After Step 6 (Re-review loop), when review is clean (no findings): if --auto flag set, invoke Skill tool with skill=\"refine\", args=\"--auto\"\n5. Skill tool is already in allowed-tools (line 8), no frontmatter change needed\n6. Chain triggers only when re-review loop exits with clean results\n7. Pass --auto flag through to fix dispatch (Step 5) so fixer knows it's in auto mode\n\n## Acceptance Criteria\n- [ ] --auto flag parsed from $ARGUMENTS\n- [ ] When --auto set: skips AskUserQuestion, defaults to \"Fix all\" severity\n- [ ] After clean review (no findings), if --auto: invokes /refine --auto\n- [ ] Chaining skipped if review never becomes clean\n- [ ] --auto flag preserved in fix dispatch (Step 5 prompt)\n- [ ] Existing flags (--against, --team, --continue) behavior unchanged\n- [ ] No regressions\n\n## Assumptions\n- Skill tool already available in allowed-tools (verified line 8)\n- Clean review is determinable by re-review loop in Step 6 (no findings returned)\n- CLAUDE_NON_INTERACTIVE check is in Step 4 footer (line 92)\n- Fix dispatch prompt is in Step 5 (references references/prompts.md)","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:59:18.885125-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.316752-08:00","deleted_at":"2026-02-14T09:16:19.316752-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.5","title":"Add Skill tool + --auto chaining to refine skill","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nAdd Skill tool to allowed-tools and implement --auto flag parsing and chaining logic to refine skill. When --auto is set and refinement completes successfully, automatically invoke /commit --auto to continue the pipeline.\n\n## Files\n- Read: ~/.claude/skills/refine/SKILL.md (understand current argument parsing, file processing flow, and completion output structure)\n- Modify: ~/.claude/skills/refine/SKILL.md (add Skill to allowed-tools, add --auto flag parsing, add Skill tool invocation after successful completion)\n\n## Approach\n1. Add Skill to allowed-tools in frontmatter (currently has only Bash(git*), Read, Edit, Glob, Grep)\n2. Add --auto to argument-hint in frontmatter (currently \"[optional: file-pattern]\" → \"[optional: file-pattern] [--auto]\")\n3. Parse --auto flag from $ARGUMENTS in Step 1 (Identify Files) — strip it before using remaining args as file pattern\n4. After Step 5 (Summary), add conditional: if --auto flag set, invoke Skill tool with skill=\"commit\", args=\"--auto\"\n5. Chain triggers only on successful refinement (after Step 4 verification passes, before Step 5 summary)\n6. Skill tool not currently in allowed-tools, needs to be added\n\n## Acceptance Criteria\n- [ ] Skill tool added to allowed-tools frontmatter\n- [ ] --auto flag parsed from $ARGUMENTS\n- [ ] After successful refinement, if --auto: invokes /commit --auto\n- [ ] File pattern parsing works correctly when --auto is present (flag stripped before pattern use)\n- [ ] Chaining skipped if no files to refine or verification fails\n- [ ] No regressions\n\n## Assumptions\n- Skill tool not currently in allowed-tools (verified: only Bash, Read, Edit, Glob, Grep)\n- Successful refinement is determinable by reaching Step 5 (summary)\n- --auto flag should be stripped from $ARGUMENTS before using remainder as file pattern\n- Step 4 verification catches broken edits, but doesn't abort entire skill","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:59:35.498574-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.362864-08:00","deleted_at":"2026-02-14T09:16:19.362864-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.6","title":"Add --auto non-interactive to commit (end of chain)","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nAdd --auto flag parsing and non-interactive behavior to commit skill. When --auto is set, skip AskUserQuestion for message confirmation and auto-approve the generated commit message. This is the end of the pipeline chain, so no further chaining needed.\n\n## Files\n- Read: ~/.claude/skills/commit/SKILL.md (understand current argument parsing, AskUserQuestion usage for commit confirmation, and commit execution flow)\n- Modify: ~/.claude/skills/commit/SKILL.md (add --auto flag parsing, add conditional logic to skip AskUserQuestion)\n\n## Approach\n1. Add --auto to argument-hint in frontmatter (currently no argument-hint shown → add \"argument-hint: \\\"[--auto]\\\"\")\n2. Parse --auto flag from $ARGUMENTS in Steps section (before step 1)\n3. Step 3 currently uses AskUserQuestion: \"Commit with this message?\". Add conditional: if --auto flag set, skip AskUserQuestion and proceed directly to step 4 (Execute)\n4. No chaining needed — commit is the end of the pipeline\n5. Skill tool not in allowed-tools and not needed (no chaining)\n6. Preserve existing behavior for special ops (amend, squash, fixup)\n\n## Acceptance Criteria\n- [ ] --auto flag parsed from $ARGUMENTS\n- [ ] When --auto set: skips AskUserQuestion, proceeds directly to commit execution\n- [ ] Generated commit message still follows conventional commit format\n- [ ] Beads sync (step 5) still executes after commit\n- [ ] Special ops (amend, squash, fixup) behavior unchanged\n- [ ] Hook failures still reported and handled correctly\n- [ ] No regressions\n\n## Assumptions\n- No argument-hint currently in frontmatter (verified: not present)\n- AskUserQuestion is in step 3 (confirmed line content: \"Confirm via AskUserQuestion\")\n- --auto should only affect confirmation step, not message generation or execution\n- Edge cases (nothing staged, clean tree) should still be handled normally","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:59:54.665674-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.409578-08:00","deleted_at":"2026-02-14T09:16:19.409578-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.7","title":"Update documentation for --auto pipeline chaining","description":"## Context\nEpic: .claude-bb7 — Auto-chain pipeline skills with --auto flag\n\n## Goal\nUpdate all relevant documentation to describe the new --auto flag and pipeline chaining behavior. This task depends on all implementation tasks (1-6) completing first.\n\n## Files\n- Read: ~/.claude/CLAUDE.md (understand current workflow skills table and flow description)\n- Read: ~/.claude/README.md (understand current pipeline section)\n- Read: ~/.claude/rules/model-tiering.md (check if any skill-related model assignments need updates)\n- Modify: ~/.claude/CLAUDE.md (update workflow skills table, add --auto to flow description)\n- Modify: ~/.claude/README.md (update pipeline section with --auto usage)\n- Modify: ~/.claude/rules/model-tiering.md (only if skill assignments need updates for auto-chaining)\n\n## Approach\n1. Read all three documentation files to understand current content\n2. Update ~/.claude/CLAUDE.md:\n   - Workflow Skills table: add note about --auto flag availability on all pipeline skills\n   - Flow section: add example of auto-chained flow: \"explore --auto → prepare → implement → review → refine → commit\"\n   - Note that --auto invokes next skill automatically on success\n3. Update ~/.claude/README.md:\n   - Pipeline section: explain --auto flag and auto-chaining behavior\n   - Add example usage showing full pipeline with --auto\n   - Note when chaining stops (commit is end, or on failure/user intervention)\n4. Check ~/.claude/rules/model-tiering.md:\n   - Skill Assignments table: verify no changes needed (auto-chaining doesn't change model assignments)\n   - Only modify if auto-chaining introduces new skill behavior requiring different model tier\n\n## Acceptance Criteria\n- [ ] ~/.claude/CLAUDE.md updated with --auto flag documentation\n- [ ] ~/.claude/README.md updated with pipeline auto-chaining examples\n- [ ] ~/.claude/rules/model-tiering.md reviewed and updated only if needed\n- [ ] Documentation explains when chaining stops (end of chain or failure)\n- [ ] Documentation includes practical usage examples\n- [ ] No regressions in existing documentation\n\n## Assumptions\n- All implementation tasks (.claude-bb7.1 through .claude-bb7.6) are complete\n- Documentation files exist and are in expected locations\n- Auto-chaining doesn't change model tier assignments (remains as currently specified)\n- README.md has a pipeline section describing workflow","status":"tombstone","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T09:00:15.150018-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:16:19.457579-08:00","deleted_at":"2026-02-14T09:16:19.457579-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".claude-bb7.8","title":"Add Skill to allowed-tools in prepare and refine","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nEnable prepare and refine skills to invoke Skill tool for continuation prompts. This is a prereq for chaining — tasks 3 and 6 need Skill tool available.\n\n## Files\n- Modify: /Users/luan/.claude/skills/prepare/SKILL.md (add Skill to allowed-tools frontmatter)\n- Modify: /Users/luan/.claude/skills/refine/SKILL.md (add Skill to allowed-tools frontmatter)\n\n## Approach\nFor each file:\n1. Read current frontmatter allowed-tools list\n2. Add `Skill` to the list (alphabetically after `Read` in refine, after `AskUserQuestion` in prepare)\n3. Preserve YAML formatting and indentation\n\n## Acceptance Criteria\n- [ ] prepare/SKILL.md frontmatter includes Skill in allowed-tools\n- [ ] refine/SKILL.md frontmatter includes Skill in allowed-tools\n- [ ] YAML frontmatter remains valid\n- [ ] No other changes to files\n\n## Assumptions\n- Both files have YAML frontmatter with allowed-tools list\n- allowed-tools is an array of strings or tool specifications","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:08:36.470662-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:13:10.132832-08:00","closed_at":"2026-02-14T09:13:10.132832-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.8","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:08:36.471324-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bb7.9","title":"Add continuation prompt to explore","description":"## Context\nEpic: .claude-bb7 — Interactive pipeline continuation\n\n## Goal\nAfter explore outputs summary, add AskUserQuestion with continuation options. If user picks continue, invoke Skill tool to trigger prepare.\n\n## Files\n- Read: /Users/luan/.claude/skills/explore/SKILL.md (understand current flow)\n- Modify: /Users/luan/.claude/skills/explore/SKILL.md (add continuation prompt after step 6)\n\n## Approach\nAdd after step 6 \"Output summary\":\n\n```markdown\n7. **Continuation prompt:**\n   Use AskUserQuestion with options:\n   - \"Continue to /prepare \u003cbead-id\u003e\" (recommended)\n   - \"Re-explore with different focus\"\n   - \"Done for now\"\n   \n   If user selects \"Continue to /prepare\":\n   - Invoke Skill tool: skill=\"prepare\", args=\"\u003cbead-id\u003e\"\n   \n   If user selects \"Re-explore\":\n   - Ask what to focus on differently\n   - Update same bead with additional findings\n```\n\n## Acceptance Criteria\n- [ ] Step 7 added to \"New Exploration\" section\n- [ ] AskUserQuestion has all 3 options with \"continue\" marked recommended\n- [ ] Skill invocation pattern matches commit skill's usage\n- [ ] No changes to escalation or continuation flag sections\n\n## Assumptions\n- explore skill already has AskUserQuestion in allowed-tools\n- Skill tool takes skill name and args parameters\n- Bead ID is available from step 1's bd create output","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T09:08:51.097426-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:13:21.412134-08:00","closed_at":"2026-02-14T09:13:21.412134-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-bb7.9","depends_on_id":".claude-bb7","type":"parent-child","created_at":"2026-02-14T09:08:51.09807-08:00","created_by":"Luan Santos"}]}
{"id":".claude-bxz","title":"Explore: Harden skills against insights friction points","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Insights Friction Analysis — Skills Hardening\n\n### Current State\n5 friction points from 158-session insights analysis. All have SOME defense in current skills/rules, but defenses are aspirational not procedural:\n\n1. **Buggy implementations (66x)**: Completion gate exists but isn't proceduralized. Workers copy untested code from prepare.\n2. **Wrong approach (65x)**: No \"read before write\" step in worker prompts. Workers skip investigation.\n3. **Indentation failures (8+ sessions)**: CLAUDE.md says \"match file style\" but workers never explicitly check.\n4. **Build errors left behind**: Gate exists in spirit but workers close tasks after own tests pass, not full build.\n5. **Context exhaustion**: Retry limit is conceptual (\"same approach\"), workers try variations indefinitely.\n\n### Root Cause\nWorker prompts in implement/SKILL.md are the ONLY text guaranteed to reach workers. Rules files, CLAUDE.md, and debugging methodology never reach them. The gap is in the worker dispatch prompt, not the rules.\n\n### Recommendation\nPrimary: Rewrite implement worker prompts with investigation-first protocol, indentation pre-flight, proceduralized build gate, fix-loop methodology, and scope limits.\nSecondary: Extend retry-limits, harden prepare task descriptions, add orchestrator scope control.\n\n### Phases\n\n**Phase 1: Harden worker prompts in implement SKILL.md**\nFiles: /Users/luan/.claude/skills/implement/SKILL.md\n- Add \"Step 0: Understand\" — read files, note indentation, verify prepared code against current state\n- Add indentation pre-flight: identify indent char + width before first Edit\n- Proceduralize completion gate: detect build cmd → run → loop max 3 → escalate\n- Wire debugging methodology: trace root cause, don't guess-and-patch\n- Scope limit: \u003e10 tool calls on single fix → checkpoint + escalate\n\n**Phase 2: Verify rules inheritance, conditionally create worker-discipline.md**\nFiles: /Users/luan/.claude/rules/worker-discipline.md (conditional)\n- Empirical test: do Task subagents see rules files?\n- If yes: extract reusable patterns into shared rules file\n- If no: document finding, skip\n\n**Phase 3: Extend retry-limits.md**\nFiles: /Users/luan/.claude/rules/retry-limits.md\n- Add worker-specific caps: 3 fix iterations total, \u003e10 tool calls → escalate\n- Keep existing main-thread rule\n\n**Phase 4: Harden prepare task descriptions**\nFiles: /Users/luan/.claude/skills/prepare/SKILL.md\n- Add ## Assumptions section requirement to prepared tasks\n- Workers verify assumptions before coding\n\n**Phase 5: Orchestrator scope control**\nFiles: /Users/luan/.claude/skills/implement/SKILL.md\n- Pause after worker escalations / \u003e2 failed verifications\n- Cap at 3 waves without progress report","status":"closed","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-13T22:44:00.443719-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:03:22.607097-08:00","closed_at":"2026-02-13T23:03:22.607097-08:00","close_reason":"Closed"}
{"id":".claude-d3t","title":"Explore: parallel commit race conditions in swarm mode","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Current State\n\nWorkers in swarm mode commit directly via merge-slot serialization (implement/SKILL.md:133):\n\n```\n8. `bd merge-slot acquire --wait` → git add/commit → `bd merge-slot release`\n```\n\nOrchestrator creates merge-slot at setup (line 90). The intent was mutual exclusion, but this fails when:\n- Workers die holding the slot → deadlock (no auto-release)\n- Intermediate refactor states fail pre-commit hooks (clippy, eslint) → workers can't commit → loop\n- Workers resort to `--no-verify` to bypass hooks → skips safety checks\n- Multiple workers touching git index simultaneously despite slot (race window during acquire)\n\n**No prohibition exists anywhere:** worker-discipline.md, CLAUDE.md Subagent Rules, and commit skill all lack guards against worker/background/team commits.\n\nSolo mode (implement/SKILL.md:52-78) has no explicit commit instruction but also no prohibition — ambiguous.\n\n## Recommendation\n\n**Workers edit files only. Orchestrator commits after each wave.**\n\nThis eliminates merge-slot entirely: no deadlocks, no hook races, no intermediate states needing to pass hooks. Hooks run once per wave on the final state. Orchestrator has full context for meaningful commit messages.\n\nCommit granularity: one commit per wave, use /split-commit later for clean history. Matches existing split-commit skill design intent.\n\nForeground solo subagents (non-team, non-background) MAY commit since there's no race — but team/background workers never.\n\n## Key Files\n\n- `/Users/luan/.claude/skills/implement/SKILL.md` — swarm worker prompt (line 133), orchestrator setup (line 90), solo worker prompt\n- `/Users/luan/.claude/rules/worker-discipline.md` — needs \"no commits\" rule\n- `/Users/luan/.claude/CLAUDE.md` — Subagent Rules section needs commit prohibition\n- `/Users/luan/.claude/skills/commit/SKILL.md` — needs context guard\n- `/Users/luan/.claude/rules/session-completion.md` — commit step scoped to main thread\n\n## Risks\n\n1. Removing merge-slot makes `bd merge-slot` commands dead code in beads\n2. Solo worker change: need orchestrator to explicitly commit after solo worker returns\n3. Workers accumulate uncommitted changes across tasks within a wave — build gate still runs on working tree so functionally fine\n4. split-commit skill subagents commit sequentially by design — different use case, leave unchanged\n5. session-completion \"commit if uncommitted\" could confuse workers — scope to main thread\n\n## Next Steps\n\n**Phase 1: Add prohibition rules**\nFiles: `/Users/luan/.claude/rules/worker-discipline.md`, `/Users/luan/.claude/CLAUDE.md`\nApproach: Add explicit \"workers never git add/commit\" to both. Workers focus on edits + build gate only.\n1. Add \"## Git Operations\" section to worker-discipline.md\n2. Add bullet to CLAUDE.md Subagent Rules\n\n**Phase 2: Modify implement skill**\nFiles: `/Users/luan/.claude/skills/implement/SKILL.md`\nApproach: Remove merge-slot from workers, add orchestrator commit step after wave completion, clarify solo mode.\n1. Remove `bd merge-slot create` from Swarm Setup (line 90)\n2. Remove step 8 from swarm worker prompt (line 133)\n3. Add orchestrator commit step after \"Wait for all workers to complete\" (after line 148)\n4. Add explicit no-commit instruction to solo worker prompt\n5. Add orchestrator commit step after solo worker returns (before continuation prompt)\n\n**Phase 3: Guard commit skill**\nFiles: `/Users/luan/.claude/skills/commit/SKILL.md`\nApproach: Add note that this is main-thread/foreground only.\n1. Add context guard at top of Steps section\n\n**Phase 4: Clarify session-completion**\nFiles: `/Users/luan/.claude/rules/session-completion.md`\nApproach: Scope commit step to main thread only.\n1. Add \"(main thread only)\" qualifier to step 5","status":"closed","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T11:24:18.708393-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:10:12.007714-08:00","closed_at":"2026-02-14T12:10:12.007714-08:00","close_reason":"Closed"}
{"id":".claude-e56","title":"Redesign skill pipeline: prepare simplification + flow reorder","description":"## Problem\nprepare spins up N opus subagents writing speculative code into tasks. Workers rewrite it anyway. Flow order has refine before review. Review's built-in fix loop is undocumented.\n\n## Solution\nONE sonnet subagent for prepare (design briefs not code). Workers own TDD. Review before refine. Document review fix loop.\n\n## Success Criteria\n- prepare uses single sonnet subagent with design brief template\n- implement workers do TDD from briefs, not copy speculative code\n- Flow: explore → prepare → implement → review → refine → commit\n- Review fix loop documented in CLAUDE.md","status":"closed","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-13T23:31:43.175839-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:43:20.996919-08:00","closed_at":"2026-02-14T08:43:20.996919-08:00","close_reason":"Closed"}
{"id":".claude-e56.1","title":"prepare: replace opus subagents with sonnet, replace code templates with design briefs","description":"## Context\nEpic: .claude-e56\n\n## Goal\nTransform prepare skill from generating full implementation code to generating design briefs. Replace N opus subagents (one per phase) with ONE sonnet subagent for all tasks. Shift from code-centric task descriptions to approach-centric design briefs.\n\n## Files\n- Read: /Users/luan/.claude/skills/prepare/SKILL.md (understand current structure, subagent dispatch, task template)\n- Modify: /Users/luan/.claude/skills/prepare/SKILL.md\n\n## Approach\n1. Update header description (line 17): \"phased tasks with full implementation code\" → \"phased tasks with design briefs\"\n2. Replace step 5 task creation template:\n   - Change from \"Complete copy-pasteable test + implementation code\" to design brief template\n   - Keep: file paths, approach, criteria, assumptions, dependencies, swarm validation\n   - Remove: \"Complete copy-pasteable test + implementation code\", \"TDD: red → green → refactor baked in\", step-by-step implementation sections\n   - Add design brief sections: Goal, Files (Read/Modify/Create with why), Approach (how to implement, key decisions), Acceptance Criteria (testable), Assumptions (what must be true about files)\n3. Change \"Spawn phases sequentially\" (line 104) to single dispatch: dispatch ONE subagent that creates ALL tasks sequentially\n4. Update subagent dispatch from opus to sonnet (line 45)\n5. Remove quality requirements lines 95-99 referencing complete code\n6. Keep: swarm validation, dependency detection, epic creation, error handling\n\n## Acceptance Criteria\n- [ ] Header description updated to reference design briefs\n- [ ] Task template changed to design brief format (Goal/Files/Approach/Criteria/Assumptions)\n- [ ] No references to \"complete code\" or \"copy-pasteable test + implementation\"\n- [ ] Single sonnet subagent dispatch instead of N opus subagents\n- [ ] File paths, acceptance criteria, assumptions still included in template\n- [ ] Swarm validation and dependency detection unchanged\n\n## Assumptions\n- SKILL.md uses yaml frontmatter + markdown sections\n- Step 5 contains the task creation template (lines 45-105)\n- Subagent dispatch uses Task tool with model parameter\n- Epic creation and swarm validation steps (4, 7) remain unchanged","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T23:32:31.199212-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:39:39.903846-08:00","closed_at":"2026-02-14T08:39:39.903846-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-e56.1","depends_on_id":".claude-e56","type":"parent-child","created_at":"2026-02-13T23:32:31.199861-08:00","created_by":"Luan Santos"}]}
{"id":".claude-e56.2","title":"implement: remove code-copying, adapt to design brief workflow","description":"## Context\nEpic: .claude-e56\n\n## Goal\nTransform implement skill from copy-paste workflow to design-driven development. Remove all references to copying prepared code. Update solo and swarm modes to read design briefs and implement from scratch using TDD.\n\n## Files\n- Read: /Users/luan/.claude/skills/implement/SKILL.md (understand pre-flight checks, solo mode per-task flow, swarm worker flow, key rules)\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md\n\n## Approach\n1. Update pre-flight check (line 47): \"tasks lack code in description → STOP\" → \"tasks lack acceptance criteria or file paths → STOP\"\n2. Solo mode per-task flow (lines 50-56):\n   - Remove: \"Copy test code EXACTLY → verify fails\", \"Copy implementation EXACTLY → verify passes\"\n   - Add: \"investigate → design → TDD from brief (not copy)\"\n   - Keep: Step 0 (understand, read files, verify assumptions, note indentation)\n   - Add after Step 0: implement using TDD based on brief's approach/criteria\n3. Swarm worker flow (lines 102-110):\n   - Replace line 108 \"Verify prepared code matches current state\" with \"Read every file. Verify assumptions. Plan approach from brief.\"\n   - Keep: indentation detection, file ownership, build gate, merge-slot\n4. Key rules section (lines 153-162):\n   - Remove line 156: \"Copy code EXACTLY from task descriptions\"\n   - Add: \"Workers own implementation — briefs give direction, not code\"\n5. Keep unchanged: task atomicity, side quests, completion gates, fix methodology, error handling\n\n## Acceptance Criteria\n- [ ] Pre-flight check updated to look for criteria/paths not code\n- [ ] Solo mode removes \"copy EXACTLY\" instructions\n- [ ] Solo mode adds TDD workflow from brief\n- [ ] Swarm worker removes code verification, adds assumption verification\n- [ ] Key rules removes \"copy code EXACTLY\", adds brief-driven language\n- [ ] Indentation detection, build gates, file ownership unchanged\n\n## Assumptions\n- SKILL.md has Solo Mode and Swarm Mode sections\n- Line numbers approximate (steps 3-5 in solo, work loop steps in swarm)\n- Pre-flight check is at beginning of Solo Mode section\n- Key Rules section exists at end of file","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T23:32:53.896586-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:40:54.743229-08:00","closed_at":"2026-02-14T08:40:54.743229-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-e56.2","depends_on_id":".claude-e56","type":"parent-child","created_at":"2026-02-13T23:32:53.897257-08:00","created_by":"Luan Santos"}]}
{"id":".claude-e56.3","title":"review/refine/docs: reorder flow, update model tier, add preconditions","description":"## Context\nEpic: .claude-e56\n\n## Goal\nUpdate workflow documentation to reflect review-includes-fixes loop and refine-after-clean-review pattern. Update model tier for prepare nested model. Add preconditions to refine skill.\n\n## Files\n- Read: /Users/luan/.claude/skills/refine/SKILL.md (skill composition table)\n- Read: /Users/luan/.claude/skills/review/SKILL.md (footer section with \"Next:\" guidance)\n- Read: /Users/luan/.claude/CLAUDE.md (workflow skills flow line)\n- Read: /Users/luan/.claude/rules/model-tiering.md (prepare nested model assignment)\n- Modify: /Users/luan/.claude/skills/refine/SKILL.md\n- Modify: /Users/luan/.claude/skills/review/SKILL.md\n- Modify: /Users/luan/.claude/CLAUDE.md\n- Modify: /Users/luan/.claude/rules/model-tiering.md\n\n## Approach\n1. refine/SKILL.md skill composition table:\n   - Add row BEFORE existing rows: \"Before refine | Run review until clean\" or similar pre-condition language\n   - Remove row \"Found real issues | review\" (review is upstream, not downstream)\n2. review/SKILL.md footer (after line 90 \"Next: `/prepare \u003cbead-id\u003e`\"):\n   - Add: \"Clean review → /refine then /commit\"\n   - Keep existing prepare guidance for new work discovery\n3. CLAUDE.md workflow flow (line 62):\n   - Change: \"explore → prepare → implement → review → commit\" → \"explore → prepare → implement → review → refine → commit\"\n   - Add note after flow: \"Review includes fix loop\" or similar to clarify review iterates internally\n4. CLAUDE.md workflow skills table (line 59):\n   - Update refine description: \"Polish post-implementation\" → \"Polish after review passes\"\n5. model-tiering.md prepare row (line 18):\n   - Change: \"prepare | inherit | opus (task creation)\" → \"prepare | inherit | sonnet (task creation)\"\n\n## Acceptance Criteria\n- [ ] refine skill composition shows pre-condition, no \"invoke review\" row\n- [ ] review footer mentions /refine for clean reviews\n- [ ] CLAUDE.md flow includes refine between review and commit\n- [ ] CLAUDE.md notes review iterates internally\n- [ ] model-tiering.md prepare nested model is sonnet\n\n## Assumptions\n- CLAUDE.md has workflow skills table and flow description in separate sections\n- review/SKILL.md has footer after Step 6b\n- refine/SKILL.md has Skill Composition table at end\n- model-tiering.md has table with prepare row","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T23:33:15.558001-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:41:57.863012-08:00","closed_at":"2026-02-14T08:41:57.863012-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-e56.3","depends_on_id":".claude-e56","type":"parent-child","created_at":"2026-02-13T23:33:15.558697-08:00","created_by":"Luan Santos"},{"issue_id":".claude-e56.3","depends_on_id":".claude-e56.1","type":"blocks","created_at":"2026-02-13T23:33:27.137457-08:00","created_by":"Luan Santos"},{"issue_id":".claude-e56.3","depends_on_id":".claude-e56.2","type":"blocks","created_at":"2026-02-13T23:33:27.193763-08:00","created_by":"Luan Santos"}]}
{"id":".claude-e56.4","title":"fix: consolidate to one bead with phased design field","description":"## Context\nEpic: .claude-e56\n\n## Goal\nChange fix skill from creating N separate beads (one per finding) to creating ONE bead with all findings structured as phases in the design field. This makes fix output directly consumable by /prepare.\n\n## Files\n- Read: skills/fix/SKILL.md (understand current N-bead approach)\n- Read: /Users/luan/.claude/references/skills/fix/SKILL.md (reference pattern)\n- Modify: skills/fix/SKILL.md\n\n## Approach\n- Single bead with phased design field\n- Phase grouping: bugs first, tasks second, features third\n- Each phase follows the **Phase N: Title** format that prepare parses\n- Keep: classification logic, dynamic context\n- Remove: per-finding bead creation loop\n\n## Acceptance Criteria\n- [ ] Fix creates ONE bead (not N)\n- [ ] Findings structured as phases in design field\n- [ ] Phases grouped by type (bug \u003e task \u003e feature)\n- [ ] Output directly consumable by /prepare (Phase N format)\n- [ ] Classification logic preserved\n\n## Assumptions\n- fix/SKILL.md currently creates separate beads in a loop per finding\n- prepare parses **Phase N: Title** format from design fields","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T08:36:36.954407-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:42:51.371797-08:00","closed_at":"2026-02-14T08:42:51.371797-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-e56.4","depends_on_id":".claude-e56","type":"parent-child","created_at":"2026-02-14T08:36:36.955-08:00","created_by":"Luan Santos"},{"issue_id":".claude-e56.4","depends_on_id":".claude-e56.1","type":"blocks","created_at":"2026-02-14T08:36:41.655405-08:00","created_by":"Luan Santos"}]}
{"id":".claude-hyl","title":"Add model: sonnet to split-commit Phase 2 dispatch","description":"Change split-commit Phase 2 per-commit dispatch to sonnet.\n\n## Edit\n\nFile: ~/.claude/skills/split-commit/SKILL.md\n\nold_string:\n```\nDispatch one subagent per commit, **sequentially**:\n```\n\nnew_string:\n```\nDispatch one subagent per commit (model: \"sonnet\"), **sequentially**:\n```\n\n## Acceptance Criteria\n- Phase 2 dispatch includes model: sonnet\n- Phase 1 dispatch unchanged (stays opus/inherit)\n- Rest of file unchanged","status":"closed","priority":1,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:49:08.99775-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:53:24.600802-08:00","closed_at":"2026-02-09T19:53:24.600802-08:00","close_reason":"Closed"}
{"id":".claude-jdi","title":"Harden skills against insights friction points","description":"## Problem\n158-session insights analysis reveals 131 friction events from buggy implementations + wrong approaches. Worker prompts lack investigation steps, build gate procedures, indentation checks, and scope limits. Rules/CLAUDE.md don't reach subagent workers.\n\n## Solution\nRewrite implement worker prompts (primary), extend retry-limits, harden prepare descriptions, add orchestrator scope control.\n\n## Success Criteria\n- Implement worker prompts include investigation-first, indentation pre-flight, proceduralized build gate\n- Retry limits extended with worker-specific caps\n- Prepare tasks include assumptions section\n- Orchestrator pauses on escalations","status":"closed","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-13T22:48:44.432234-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:03:22.530213-08:00","closed_at":"2026-02-13T23:03:22.530213-08:00","close_reason":"Closed"}
{"id":".claude-jdi.1","title":"Harden implement worker prompts with investigation, build gates, and scope limits","description":"## Context\nEpic: .claude-jdi — Harden skills against insights friction points\nPhase 1: Highest-leverage change. Worker prompts are the ONLY text\nguaranteed to reach subagent workers.\n\n## Files\n- Modify: skills/implement/SKILL.md\n\n## Acceptance Criteria\n- [ ] Solo worker prompt includes read-files-first step\n- [ ] Indentation pre-flight before first Edit\n- [ ] Completion gate is numbered procedure with max 3 fix attempts\n- [ ] Fix methodology references root-cause tracing\n- [ ] Scope limit: \u003e10 tool calls on fix → escalate\n- [ ] Swarm worker prompt has equivalent additions\n- [ ] Prompt additions are terse (matching existing style)\n\n## Implementation\n\n### Edit 1: Solo Mode — Add Step 0 + indentation + fix methodology\n\nold_string:\n```\n5. Per task:\n   - `bd show \u003ctask-id\u003e` + `bd update \u003ctask-id\u003e --claim`\n   - Copy test code EXACTLY → verify fails\n   - Copy implementation EXACTLY → verify passes\n   - **Completion gate (MANDATORY):** No `bd close` without ALL:\n     1. Build clean (zero errors)\n     2. Tests pass (new + existing in scope)\n     3. Linter clean (clippy/eslint/swiftc as applicable)\n     Detect build cmd from justfile/Makefile/package.json/CLAUDE.md.\n     ANY failure → fix loop. Never skip.\n   - `bd close \u003ctask-id\u003e`\n```\n\nnew_string:\n```\n5. Per task:\n   - `bd show \u003ctask-id\u003e` + `bd update \u003ctask-id\u003e --claim`\n   - **Step 0 — Understand:** Read EVERY file listed in task. Note indent style (tabs vs spaces + width). Verify prepared code matches current file state. Adapt if diverged.\n   - **Indentation pre-flight:** Before first Edit to any file: read file, identify indent char + width. Use EXACTLY that in all edits to that file.\n   - Copy test code EXACTLY → verify fails\n   - Copy implementation EXACTLY → verify passes\n   - **Completion gate (before bd close):**\n     1. Detect build cmd: justfile/Makefile/package.json/CLAUDE.md\n     2. Run build. Exit != 0 → trace error to root cause, fix (max 3 attempts)\n     3. Run tests: new + existing touching modified files\n     4. Run linter if applicable\n     5. ALL green → `bd close`. ANY red after 3 attempts → report error output, do NOT close\n   - **Fix methodology:** Read error → trace to root cause → ONE targeted fix. No guess-and-patch. \u003e10 tool calls on single fix → checkpoint findings + escalate to caller.\n   - `bd close \u003ctask-id\u003e`\n```\n\n### Edit 2: Swarm Mode — Add investigation + gates to worker prompt\n\nold_string:\n```\n  ## Work Loop\n  1. `bd ready --parent \u003cepic-id\u003e --unassigned`\n  2. `bd show \u003cid\u003e` → `bd update \u003cid\u003e --claim` (fails if claimed → step 1)\n  3. Respect file ownership — YOUR files while in_progress\n  4. Failing test FIRST → minimal implementation\n  4b. Build check. Fix until clean.\n  5. `bd merge-slot acquire --wait` → git add/commit → `bd merge-slot release`\n  6. `bd close \u003cid\u003e`\n  7. → step 1. Empty → report completion\n```\n\nnew_string:\n```\n  ## Work Loop\n  1. `bd ready --parent \u003cepic-id\u003e --unassigned`\n  2. `bd show \u003cid\u003e` → `bd update \u003cid\u003e --claim` (fails if claimed → step 1)\n  3. **Understand first:** Read every file in task. Note indent (char + width). Verify prepared code matches current state. Adapt if diverged.\n  4. Respect file ownership — YOUR files while in_progress\n  5. Before first Edit per file: read it, match indent exactly.\n  6. Failing test FIRST → minimal implementation\n  7. **Build gate (max 3 attempts):**\n     a. Build cmd from justfile/Makefile/package.json/CLAUDE.md\n     b. Build + tests + linter. All green → continue. Red → root-cause, ONE fix.\n     c. 3 fails → report error, do NOT close.\n     d. \u003e10 tool calls on one fix → checkpoint + escalate.\n  8. `bd merge-slot acquire --wait` → git add/commit → `bd merge-slot release`\n  9. `bd close \u003cid\u003e`\n  10. → step 1. Empty → report completion\n```","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:49:27.385627-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:01:27.744691-08:00","closed_at":"2026-02-13T23:01:27.744691-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-jdi.1","depends_on_id":".claude-jdi","type":"parent-child","created_at":"2026-02-13T22:49:27.386291-08:00","created_by":"Luan Santos"}]}
{"id":".claude-jdi.2","title":"Verify rules inheritance and conditionally create worker-discipline.md","description":"## Context\nEpic: .claude-jdi — Harden skills against insights friction points\n\n## Files\n- Create (conditional): rules/worker-discipline.md\n\n## Acceptance Criteria\n- [ ] Empirical test confirms whether Task subagents see rules/*.md\n- [ ] If YES: worker-discipline.md created with indentation protocol, build gate, scope limits\n- [ ] If NO: finding documented, phase closed without file creation\n\n## Implementation\n\n### Step 1: Empirical test\nDispatch a Task subagent (subagent_type=general-purpose) with prompt:\n\"List any rules or instructions you see from files in /Users/luan/.claude/rules/. Quote the first line from each rule file you can see. If you see none, say NONE.\"\n\n### Step 2: Evaluate result\n- If subagent quotes content from rules files → rules ARE inherited → proceed to Step 3\n- If subagent says NONE → rules are NOT inherited → skip to Step 4\n\n### Step 3: Create worker-discipline.md (only if rules inherited)\nWrite /Users/luan/.claude/rules/worker-discipline.md:\n```markdown\n# Worker Discipline\n\n## Indentation Pre-Flight\nBefore first Edit to any file: read file, identify indent style (tabs vs spaces + width). Use EXACTLY that in all edits. Tab/space mismatch causes cascading Edit tool failures.\n\n## Build Gate (before closing any task)\n1. Detect build cmd: justfile/Makefile/package.json/CLAUDE.md\n2. Run build. Exit != 0 → trace error to root cause, fix (max 3 attempts)\n3. Run tests: new + existing touching modified files\n4. Run linter if applicable\n5. ALL green → close task. Red after 3 → escalate with error output\n\n## Fix Methodology\nWhen build/test fails: read the error, trace to root cause, make ONE targeted fix per attempt. Do NOT guess-and-patch.\n\n## Scope Limits\n- Max 3 fix iterations per failure (total, not per approach)\n- \u003e10 tool calls on single fix → checkpoint findings and escalate\n- Never start new task after 3+ completed tasks without orchestrator check-in\n```\n\n### Step 4: Document finding\nReport whether rules are inherited or not.","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:49:57.399714-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:00:51.111756-08:00","closed_at":"2026-02-13T23:00:51.111756-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-jdi.2","depends_on_id":".claude-jdi","type":"parent-child","created_at":"2026-02-13T22:49:57.400316-08:00","created_by":"Luan Santos"}]}
{"id":".claude-jdi.3","title":"Extend retry-limits with worker-specific caps","description":"## Context\nEpic: .claude-jdi — Harden skills against insights friction points\n\n## Files\n- Modify: rules/retry-limits.md\n\n## Acceptance Criteria\n- [ ] Worker Fix Loops section added\n- [ ] Hard numeric caps: 3 fix iterations total, \u003e10 tool calls → escalate\n- [ ] Existing main-thread rule preserved\n\n## Implementation\n\n### Step 1: Read current file\nRead /Users/luan/.claude/rules/retry-limits.md\n\n### Step 2: Add worker section\nAppend after existing content:\n\n## Worker Fix Loops\n- Max 3 fix iterations per failure (total, not per approach)\n- \u003e10 tool calls on single fix → checkpoint findings + escalate to caller\n- After 3+ completed tasks in one session → report status before starting next","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:50:17.238889-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:00:49.565294-08:00","closed_at":"2026-02-13T23:00:49.565294-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-jdi.3","depends_on_id":".claude-jdi","type":"parent-child","created_at":"2026-02-13T22:50:17.239509-08:00","created_by":"Luan Santos"}]}
{"id":".claude-jdi.4","title":"Add assumptions section requirement to prepare task descriptions","description":"## Context\nEpic: .claude-jdi — Harden skills against insights friction points\n\n## Files\n- Modify: /Users/luan/.claude/skills/prepare/SKILL.md\n\n## Acceptance Criteria\n- [ ] Subagent prompt includes requirement for ## Assumptions section\n- [ ] Workers can verify assumptions before blindly copying code\n\n## Implementation\n\n### Step 1: Read file\nRead /Users/luan/.claude/skills/prepare/SKILL.md\n\n### Step 2: Add to Quality Requirements section\nAfter line 100 (existing quality requirements bullets), add new requirement:\n- Include ## Assumptions section listing what must be true about referenced files (structure, imports, exports) for implementation to work. Workers verify these before coding.","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:50:45.259713-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:02:04.008848-08:00","closed_at":"2026-02-13T23:02:04.008848-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-jdi.4","depends_on_id":".claude-jdi","type":"parent-child","created_at":"2026-02-13T22:50:45.260348-08:00","created_by":"Luan Santos"},{"issue_id":".claude-jdi.4","depends_on_id":".claude-jdi.1","type":"blocks","created_at":"2026-02-13T22:51:23.766401-08:00","created_by":"Luan Santos"}]}
{"id":".claude-jdi.5","title":"Add orchestrator scope control to implement wave loop","description":"## Context\nEpic: .claude-jdi — Harden skills against insights friction points\n\n## Files\n- Modify: skills/implement/SKILL.md\n\n## Acceptance Criteria\n- [ ] Wave loop pauses if any worker reports escalation or \u003e2 tasks failed verification\n- [ ] Wave loop caps at 3 waves without user progress report\n- [ ] Existing verify-fix loop preserved\n\n## Implementation\n\n### Step 1: Read file\nRead /Users/luan/.claude/skills/implement/SKILL.md\n\n### Step 2: Add to Wave Loop\nAfter \"Wait for all workers to complete.\" and before \"Check bd swarm status\", add:\n- If any worker reported escalation or \u003e2 tasks failed build gate → PAUSE. Report status to user before continuing.\n- After 3 waves, report progress to user regardless. Do not run unbounded wave loops.","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-13T22:51:13.562691-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T23:02:48.818599-08:00","closed_at":"2026-02-13T23:02:48.818599-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-jdi.5","depends_on_id":".claude-jdi","type":"parent-child","created_at":"2026-02-13T22:51:13.563345-08:00","created_by":"Luan Santos"},{"issue_id":".claude-jdi.5","depends_on_id":".claude-jdi.1","type":"blocks","created_at":"2026-02-13T22:51:23.696815-08:00","created_by":"Luan Santos"}]}
{"id":".claude-kgh","title":"Add model: sonnet to compress-prompt + haiku nested dispatches","description":"Two changes in compress-prompt/SKILL.md:\n\n## Edit 1: Frontmatter\n\nold_string:\n```\ncontext: fork\nagent: general-purpose\n```\n\nnew_string:\n```\ncontext: fork\nagent: general-purpose\nmodel: sonnet\n```\n\n## Edit 2: Nested dispatch\n\nold_string:\n```\n   - subagent_type: \"general-purpose\"\n```\n\nnew_string:\n```\n   - subagent_type: \"general-purpose\"\n   - model: \"haiku\"\n```\n\n## Acceptance Criteria\n- model: sonnet in frontmatter\n- model: haiku in nested Task dispatch\n- Rest of file unchanged","status":"closed","priority":1,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:48:58.767192-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:53:22.687848-08:00","closed_at":"2026-02-09T19:53:22.687848-08:00","close_reason":"Closed"}
{"id":".claude-ktm","title":"Add model: sonnet to feedback skill dispatch","description":"Change feedback dispatch to use sonnet model.\n\n## Edit\n\nFile: ~/.claude/skills/feedback/SKILL.md\n\nold_string:\n```\nSpawn general-purpose agent via Task:\n```\n\nnew_string:\n```\nSpawn general-purpose agent via Task (model: \"sonnet\"):\n```\n\n## Acceptance Criteria\n- Dispatch instruction includes model: sonnet\n- Rest of file unchanged","status":"closed","priority":1,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:49:00.192115-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:53:23.564471-08:00","closed_at":"2026-02-09T19:53:23.564471-08:00","close_reason":"Closed"}
{"id":".claude-lge","title":"Fix implement branch creation and commit granularity","description":"## Problem\n/implement unconditionally creates branches (gt create) on every invocation, causing branch sprawl across sessions. It also commits at the wrong granularity (one commit for all tasks or per wave), forcing /split-commit cleanup every time.\n\n## Solution\n1. Remove branch creation from implement — /start is the branch entry point, implement works on current branch\n2. Replace per-task/per-wave commits with a single WIP commit\n3. Add stale branch detection to resume-work\n4. Update session-completion with branch housekeeping\n\n## Success Criteria\n- Implement never runs gt create\n- Implement produces exactly one WIP commit after all work\n- Continuation prompt suggests /split-commit instead of /review\n- CLAUDE.md flow updated: implement → split-commit → review\n- resume-work detects stale branches\n- session-completion mentions branch cleanup","status":"in_progress","priority":1,"issue_type":"epic","owner":"github@luan.sh","created_at":"2026-02-14T12:38:15.361405-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:42:21.358369-08:00"}
{"id":".claude-lge.1","title":"Remove branch creation from implement skill","description":"## Context\nEpic: .claude-lge\nPhase: 1 of 4\n\n## Goal\nRemove git branch creation from implement skill. Branch creation should happen in start skill only, not during implementation.\n\n## Files\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md\n  - Solo mode (line 56): delete `gt create luan/\u003cshort-description\u003e`\n  - Swarm mode (line 93): delete `gt create luan/\u003cshort-description\u003e`\n  - Swarm worker context (line 149): change from hardcoded \"Branch: luan/\u003cdescription\u003e (already created)\" to dynamically reference current branch with \"Branch: !`git branch --show-current`\"\n  - Key Rules section (line 184): update to reflect no branch creation\n\n## Approach\n1. Delete line 56 in Solo Mode step 2\n2. Delete line 93 in Swarm Mode setup step 4\n3. In Swarm worker context line 149, replace hardcoded branch reference with dynamic: \"Branch: !`git branch --show-current`\"\n4. Update Key Rules section to remove any references to branch creation\n5. Renumber steps after deletions\n\n## Acceptance Criteria\n- [ ] Solo mode no longer creates branches\n- [ ] Swarm mode no longer creates branches\n- [ ] Worker context dynamically references current branch\n- [ ] No references to branch creation in implement skill\n- [ ] Step numbering is sequential after changes\n\n## Assumptions\n- start skill already handles branch creation\n- Current branch is always valid when implement runs\n- Workers need to know current branch for context","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T12:38:48.090121-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:43:41.124466-08:00","closed_at":"2026-02-14T12:43:41.124466-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-lge.1","depends_on_id":".claude-lge","type":"parent-child","created_at":"2026-02-14T12:38:48.094707-08:00","created_by":"Luan Santos"}]}
{"id":".claude-lge.2","title":"Replace per-wave commits with single WIP commit","description":"## Context\nEpic: .claude-lge\nPhase: 2 of 4\nDepends on: Phase 1 (branch creation removal)\n\n## Goal\nReplace frequent per-wave commits in implement with single WIP commit after all work. Update flow to recommend split-commit before review.\n\n## Files\n- Modify: /Users/luan/.claude/skills/implement/SKILL.md\n  - Solo mode (line 81): replace commit with single WIP commit after all tasks\n  - Swarm mode (line 153): remove per-wave commits, add single WIP commit in Teardown\n  - Continuation prompt (line 176-182): change \"Continue to /review\" to \"Continue to /split-commit\" with note about /review after\n  - Key Rules section: update to reflect WIP commit strategy\n\n- Modify: /Users/luan/.claude/CLAUDE.md\n  - Line 62: update flow from \"explore → prepare → implement → review → refine → commit\" to \"explore → prepare → implement → split-commit → review → refine → commit\"\n\n## Approach\n1. Solo mode: replace line 81 with single WIP commit after step 5 completes all tasks: `git add . \u0026\u0026 git diff --staged --quiet || git commit -m 'wip: implement \u003cepic-title\u003e (\u003cid\u003e)'`\n2. Swarm mode: delete per-wave commit at line 153\n3. Swarm mode Teardown: add single WIP commit after step 1 (shutdown teammates), before TeamDelete: `git add . \u0026\u0026 git diff --staged --quiet || git commit -m 'wip: implement \u003cepic-title\u003e (\u003cid\u003e)'`\n4. Update Continuation Prompt to recommend /split-commit as first option, then /review after split-commit completes\n5. Update CLAUDE.md workflow flow to insert split-commit between implement and review\n6. Update Key Rules to reflect orchestrator creates single WIP commit (not per-wave)\n\n## Acceptance Criteria\n- [ ] Solo mode creates one WIP commit after all tasks complete\n- [ ] Swarm mode creates one WIP commit in Teardown after shutdown\n- [ ] No per-wave commits in Swarm mode\n- [ ] Continuation prompt recommends /split-commit before /review\n- [ ] CLAUDE.md workflow flow includes split-commit step\n- [ ] Key Rules accurately reflect WIP commit strategy\n- [ ] Commit messages use format: \"wip: implement \u003cepic-title\u003e (\u003cid\u003e)\"\n\n## Assumptions\n- split-commit skill exists and can handle WIP commits\n- WIP commits are acceptable temporary state\n- Single commit easier to split than multiple commits to combine\n- Review should happen after proper commit messages applied","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T12:39:05.512327-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:45:25.878955-08:00","closed_at":"2026-02-14T12:45:25.878955-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-lge.2","depends_on_id":".claude-lge","type":"parent-child","created_at":"2026-02-14T12:39:05.513009-08:00","created_by":"Luan Santos"},{"issue_id":".claude-lge.2","depends_on_id":".claude-lge.1","type":"blocks","created_at":"2026-02-14T12:39:05.513763-08:00","created_by":"Luan Santos"}]}
{"id":".claude-lge.3","title":"Add stale branch detection to resume-work","description":"## Context\nEpic: .claude-lge\nPhase: 3 of 4\nIndependent of phases 1-2\n\n## Goal\nAdd stale branch detection to resume-work skill. Cross-reference local luan/* branches with beads in_progress status to surface branches that may need cleanup.\n\n## Files\n- Modify: /Users/luan/.claude/skills/resume-work/SKILL.md\n  - After step 2 (PR context), add new step 3 for stale branch detection\n  - Update existing step 3 (Summarize) to step 4\n  - Update existing step 4 (Suggest next action) to step 5\n  - Add stale branches to summary output in step 4\n\n## Approach\n1. Add new step 3 between PR context and Summarize:\n   ```\n   3. **Check for stale branches:**\n      - List all local luan/* branches: `git branch --list 'luan/*' --format='%(refname:short)'`\n      - Get in_progress beads: `bd list --status in_progress`\n      - Cross-reference: branches without matching in_progress beads are potentially stale\n      - Never auto-delete — only surface for user awareness\n   ```\n\n2. Update step 4 (Summarize) to include stale branch info:\n   ```\n   Stale branches: \u003clist\u003e (no matching in_progress beads)\n   ```\n   Only show this line if stale branches exist.\n\n3. Renumber existing steps 3-4 to 4-5\n\n## Acceptance Criteria\n- [ ] resume-work lists local luan/* branches\n- [ ] Compares branches to beads in_progress status\n- [ ] Identifies branches without matching in_progress beads\n- [ ] Includes stale branches in summary (if any exist)\n- [ ] Never auto-deletes branches\n- [ ] Step numbering is sequential\n\n## Assumptions\n- Branch naming convention is luan/*\n- Beads in_progress status indicates active work\n- Branch name correlates with bead title/description (loose matching acceptable)\n- User wants visibility into stale branches for manual cleanup","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T12:39:22.604866-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:44:06.702037-08:00","closed_at":"2026-02-14T12:44:06.702037-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-lge.3","depends_on_id":".claude-lge","type":"parent-child","created_at":"2026-02-14T12:39:22.605542-08:00","created_by":"Luan Santos"}]}
{"id":".claude-lge.4","title":"Add branch housekeeping to session completion","description":"## Context\nEpic: .claude-lge\nPhase: 4 of 4\nIndependent of all other phases\n\n## Goal\nAdd non-blocking branch awareness to session completion rule. Suggest stale branch cleanup without making it mandatory.\n\n## Files\n- Modify: /Users/luan/.claude/rules/session-completion.md\n  - Add new step 6 for branch housekeeping awareness\n  - Keep it non-mandatory (suggestion only)\n\n## Approach\n1. Add new step 6 after step 5 (Commit code changes):\n   ```\n   6. Note stale branches for cleanup (optional) — list local luan/* branches without matching in_progress beads as cleanup suggestion\n   ```\n\n2. Keep language as \"Note\" or \"Suggest\" — not \"Delete\" or \"Clean up\"\n3. This is informational only, not a gate or requirement\n\n## Acceptance Criteria\n- [ ] New step added after commit step\n- [ ] Language is non-blocking (suggestion, not requirement)\n- [ ] Does not mandate any action\n- [ ] Numbered as step 6\n- [ ] Clear it's optional/informational\n\n## Assumptions\n- Session completion already enforces mandatory steps 1-5\n- Stale branches are low-priority housekeeping\n- User may choose to ignore stale branch suggestions\n- Branch cleanup is manual and deliberate, never automatic","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-14T12:39:35.466056-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T12:44:24.116822-08:00","closed_at":"2026-02-14T12:44:24.116822-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-lge.4","depends_on_id":".claude-lge","type":"parent-child","created_at":"2026-02-14T12:39:35.466659-08:00","created_by":"Luan Santos"}]}
{"id":".claude-oak","title":"Test: hook verification","status":"tombstone","priority":4,"issue_type":"bug","owner":"github@luan.sh","created_at":"2026-02-08T19:21:03.130775-08:00","created_by":"Luan Santos","updated_at":"2026-02-08T19:21:13.716805-08:00","deleted_at":"2026-02-08T19:21:13.716805-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":".claude-p64","title":"Review: interactive pipeline continuation","description":"## Acceptance Criteria\n- All skill changes reviewed for correctness and consistency\n- No regressions in existing skill behavior","design":"Critical: (1) implement solo continuation inside code block fence (2) refine missing AskUserQuestion in allowed-tools. High: (3) explore continuation duplicated (4) review line 100 echo conflicts with Step 7. Medium: (5) review format inconsistent (6) implement swarm duplication (7) re-review loop risk. Low: (8) Done-for-now cleanup unspecified (9) commit interviewing on haiku (10) refine heading style.","status":"closed","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T09:21:03.381813-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:33:26.171744-08:00","closed_at":"2026-02-14T09:33:26.171744-08:00","close_reason":"Closed"}
{"id":".claude-r1z","title":"Explore: one-shot pipeline + skill auto-chaining","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Current State\n\n### Pipeline Flow\nexplore → prepare → implement → review → refine → commit\n\n### Handoff Mechanism\nAll handoffs mediated by beads IDs or git state — no direct data passing.\n\n### Skill Tool Availability\n- HAS Skill tool: explore, implement, review\n- MISSING Skill tool: prepare, refine, commit\n\n### Current Problem\nSkills run, print \"Next: /prepare \u003cid\u003e\", and stop. User copy-pastes.\nSkills also don't ask enough questions when facing ambiguity.\n\n## Recommendation: Interactive continuation + better interviewing\n\nTwo changes to each pipeline skill:\n\n### 1. Continuation prompt at end of each skill\nAfter successful completion, use AskUserQuestion to offer context-aware next steps. Not a blind \"continue Y/N\" — the options should reflect what actually makes sense given the outcome.\n\nExamples:\n- explore finishes → \"I found 3 phases. Continue to /prepare .claude-xyz?\" with options like \"Continue to prepare\", \"Re-explore with different focus\", \"I want to review findings first\"\n- review finds issues → \"Found 4 issues (2 high, 2 low). Fix and continue?\" with options like \"Fix all and continue to refine\", \"Let me review the findings\", \"Re-review with different focus\"\n- review is clean → \"Clean review. Continue to /refine?\" with options like \"Continue to refine\", \"Skip refine, go to commit\"\n\n### 2. Better interviewing during skills\nSkills should use AskUserQuestion when facing genuine ambiguity:\n- explore: multiple viable approaches → ask which direction\n- prepare: unclear task boundaries → ask how to split\n- implement: design decision mid-coding → surface it\n- review: severity judgment calls → ask user\n\n### What this is NOT:\n- No --auto flag\n- No orchestrator skill\n- No hook-based triggering\n- Skills stay independently invocable — continuation is just a question at the end\n\n### Chain logic per skill:\n| Skill | On success, asks | Passes to next |\n|-------|-----------------|----------------|\n| explore | \"Continue to /prepare \u003cid\u003e?\" | bead ID |\n| prepare | \"Continue to /implement \u003cepic-id\u003e?\" | epic ID |\n| implement | \"Continue to /review?\" | (git state) |\n| review (clean) | \"Continue to /refine?\" or \"Skip to /commit?\" | (git state) |\n| review (issues) | \"Fix and continue?\" or \"Review findings?\" | (git state) |\n| refine | \"Continue to /commit?\" | (git state) |\n| commit | (end — no continuation) | — |\n\n## Key Files\n- MODIFY: ~/.claude/skills/explore/SKILL.md\n- MODIFY: ~/.claude/skills/prepare/SKILL.md (+ add Skill to allowed-tools)\n- MODIFY: ~/.claude/skills/implement/SKILL.md\n- MODIFY: ~/.claude/skills/review/SKILL.md\n- MODIFY: ~/.claude/skills/refine/SKILL.md (+ add Skill to allowed-tools)\n- No change to commit (end of chain)\n\n## Risks\n- **Context exhaustion**: Long chains still consume context. Mitigated by subagent dispatch in each skill.\n- **AskUserQuestion fatigue**: Too many questions annoys user. Keep it to genuine ambiguity + one continuation prompt at the end.\n- **Continuation options must be smart**: Generic \"continue Y/N\" is useless. Options must reflect actual state (e.g., review outcome determines what to offer).\n\n## Next Steps\n\n**Phase 1: Add Skill tool to prepare and refine**\nFiles: ~/.claude/skills/prepare/SKILL.md, ~/.claude/skills/refine/SKILL.md\nApproach: Add Skill to allowed-tools in frontmatter. Prerequisite for chaining.\n1. Add Skill to prepare's allowed-tools\n2. Add Skill to refine's allowed-tools\n\n**Phase 2: Add continuation prompts to pipeline skills**\nFiles: All 5 chainable skills (explore, prepare, implement, review, refine)\nApproach: Add \"## Continuation\" section at end of each skill. After successful completion, use AskUserQuestion with context-aware options. If user picks \"continue\", invoke next skill via Skill tool with appropriate args.\n1. explore: ask with bead ID context\n2. prepare: ask with epic ID + task count context\n3. implement: ask with build/test status context\n4. review: ask with findings summary context (different options for clean vs issues)\n5. refine: ask with changes-made context\n\n**Phase 3: Improve interviewing during skills**\nFiles: Same 6 skills\nApproach: Add guidance in each skill for when to use AskUserQuestion during execution (not just at the end). This is skill-specific — explore has different ambiguity than implement.\n1. explore: ask when multiple viable approaches found\n2. prepare: ask when task boundaries unclear\n3. implement: surface design decisions to user\n4. review: ask about severity judgments","status":"in_progress","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T08:50:04.689263-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T09:07:43.385866-08:00"}
{"id":".claude-sdg","title":"pr-fix-comments skill for dot-claude","description":"## Problem\nUpstream pr-fix-comments uses `git push` (breaks Graphite) and hardcodes repo.\nOld dot-claude version was deleted Feb 11. Need repo-agnostic replacement.\n\n## Solution\nNew skill at `~/.claude/skills/pr-fix-comments/` with:\n- Repo-agnostic script (auto-detect via `gh repo view`)\n- Standard python3 + argparse (no external deps)\n- Two-phase: commit (ask) → push separately (ask)\n- Uses `gt ss --update-only` not `git push`\n\n## Success Criteria\n- Script runs standalone: `python3 scripts/pr_threads.py fetch --pr \u003cN\u003e`\n- Skill uses Graphite for push\n- Commit and push are separate confirmations\n- No external dependencies beyond stdlib","status":"closed","priority":1,"issue_type":"epic","owner":"luan@thebrowser.company","created_at":"2026-02-13T11:22:07.589056-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T08:48:16.175367-08:00","closed_at":"2026-02-14T08:48:16.175367-08:00","close_reason":"Closed"}
{"id":".claude-sdg.1","title":"Create skill.md for pr-fix-comments","description":"## Context\nEpic: .claude-sdg\nDepends on: pr_threads.py script task\n\n## Files\n- Create: ~/.claude/skills/pr-fix-comments/skill.md\n\n## Acceptance Criteria\n- [x] Frontmatter matches pr-fix-gha pattern\n- [x] Uses python3 + global path for script\n- [x] Commit and push are separate steps with separate confirmations\n- [x] Push uses gt ss --update-only\n- [x] Never auto-pushes\n- [x] Commit uses Skill tool: commit\n\n## Implementation\n\n### Step 1: Create skill.md\n\n```markdown\n---\nname: pr-fix-comments\ndescription: \"Fix unresolved PR review comments. Triggers: 'fix comments', 'fix PR comments', 'address review feedback'.\"\nuser-invocable: true\nallowed-tools:\n  - \"Bash(python3 ~/.claude/skills/pr-fix-comments/scripts/pr_threads.py *)\"\n  - \"Bash(gh pr view *)\"\n  - \"Bash(gh pr list *)\"\n  - \"Bash(git branch --show-current)\"\n  - \"Bash(git add *)\"\n  - \"Bash(gt *)\"\n  - Read\n  - Edit\n  - Glob\n  - Grep\n---\n\n# PR Comments Fixer\n\nFix unresolved review comments from a PR.\n\n**Safety: NEVER auto-pushes. Push optional + requires confirmation.**\n\n## Steps\n\n1. **Detect PR**: `gh pr view --json number -q '.number'` or ask user\n\n2. **Verify branch** (if PR specified manually):\n   - `git branch --show-current` vs `gh pr view \u003cPR\u003e --json headRefName -q .headRefName`\n   - Mismatch → ask user\n\n3. **Fetch and display comments**:\n\n   ```bash\n   python3 ~/.claude/skills/pr-fix-comments/scripts/pr_threads.py fetch --pr \u003cPR\u003e\n   ```\n\n   Display as numbered list with file:line, author, preview.\n   Ask \"Which comment(s) to fix?\" with options: \"Fix all\" / \"Other\"\n\n4. **Plan fixes**: For each comment, read code, create one-line fix description.\n   Ask \"Ready to execute?\"\n\n5. **Execute**: Apply fixes, summarize changes.\n\n6. **Commit**: Use `Skill tool: commit` to generate message and commit.\n\n7. **Push** (optional): Ask first, then `gt ss --update-only`\n\n8. **Resolve threads**: Show planned replies, ask confirmation, then:\n\n   ```bash\n   python3 ~/.claude/skills/pr-fix-comments/scripts/pr_threads.py reply --pr \u003cPR\u003e --comment-id \u003cID\u003e --body \"\u003cmessage\u003e\"\n   python3 ~/.claude/skills/pr-fix-comments/scripts/pr_threads.py resolve --thread-id \u003cTHREAD_ID\u003e\n   ```\n\n   Reply format:\n   - Exact fix: \"Done [pr-fix-comments]\"\n   - Custom fix: \"{brief explanation} [pr-fix-comments]\"\n\n## Notes\n\n- User confirms plan before execution\n- NEVER post thread replies without showing user first\n- Be concise — don't over-explain trivial fixes\n```","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"luan@thebrowser.company","created_at":"2026-02-13T11:22:58.199358-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T11:26:45.101464-08:00","closed_at":"2026-02-13T11:26:45.101464-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-sdg.1","depends_on_id":".claude-sdg","type":"parent-child","created_at":"2026-02-13T11:22:58.200053-08:00","created_by":"Luan Santos"},{"issue_id":".claude-sdg.1","depends_on_id":".claude-sdg.2","type":"blocks","created_at":"2026-02-13T11:23:18.757028-08:00","created_by":"Luan Santos"}]}
{"id":".claude-sdg.2","title":"Port pr_threads.py to argparse with auto-detection","description":"## Context\nEpic: .claude-sdg — Port pr-fix-comments skill to be repo-agnostic.\n\n## Files\n- Create: ~/.claude/skills/pr-fix-comments/scripts/pr_threads.py\n\n## Acceptance Criteria\n- [ ] Uses python3 shebang, no external deps\n- [ ] Auto-detects repo via `gh repo view --json nameWithOwner`\n- [ ] Same CLI interface: fetch/resolve/reply with same flags\n- [ ] Same JSON output format\n- [ ] Runs standalone: `python3 pr_threads.py fetch --pr 12345`","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"luan@thebrowser.company","created_at":"2026-02-13T11:23:04.68033-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T11:43:36.562254-08:00","closed_at":"2026-02-13T11:26:06.043947-08:00","close_reason":"Closed","dependencies":[{"issue_id":".claude-sdg.2","depends_on_id":".claude-sdg","type":"parent-child","created_at":"2026-02-13T11:23:04.681178-08:00","created_by":"Luan Santos"}]}
{"id":".claude-sst","title":"Explore: pr-description skill for dot-claude","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable","design":"## Current State\n\n**Location**: Upstream repo-local skill (not in dot-claude).\n\n**Flow**:\n1. Check git state (on branch, has commits)\n2. Get diff via `git diff origin/main...HEAD`\n3. LLM generates title + body from diff\n4. Offers to create/update PR\n\n**Problem**: Title generation uses generic LLM patterns, ignores conventional commit format from commit skill.\n\n## Recommendation\n\nSingle-file skill at `~/.claude/skills/pr-description/skill.md` that:\n1. Embeds conventional commit title format rules (same as commit skill)\n2. Generates WHY-focused body\n3. Assumes existing PR — update only\n4. Never auto-submits — preview + confirm\n\n## Risks\n\n- Conventions drift if commit skill changes (low risk — format is stable)\n- Stacked PRs: diff should be vs stack parent, not main","status":"closed","priority":2,"issue_type":"task","owner":"luan@thebrowser.company","created_at":"2026-02-13T14:40:33.635676-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T14:53:37.452171-08:00","closed_at":"2026-02-13T14:51:54.544879-08:00"}
{"id":".claude-u26","title":"Explore: Audit and revise all skills against Anthropic best practices","description":"## Acceptance Criteria\n- Findings stored in bead design field\n- Structured as Current State, Recommendation, and phased Next Steps\n- Each phase includes file paths and is independently actionable\n- All skills audited against Anthropic's Complete Guide to Building Skills\n- writing-skills skill verified first","design":"## Skills Audit Against Anthropic Best Practices Guide\n\n### Current State\n20 skills found. 18 correct `SKILL.md`, 2 broken (`skill.md`). Generally high quality with consistent internal style. Main systemic issues: 2 wrong filenames, description gaps, missing structural rules in writing-skills, references to nonexistent skills.\n\n### Writing-Skills Verdict\nTeaches good TDD methodology for skill creation (keep this). But has material gaps:\n- Missing rules: no claude/anthropic names, no XML in frontmatter, no README.md, \u003c1024 char limit\n- Description guidance contradicts guide: says \"ONLY triggers\" but guide requires WHAT + WHEN\n- Missing standard dirs: references/, assets/\n- Missing progressive disclosure 3-level model explanation\n\n### Per-Skill Grades\nA: refine, pr-reviewers\nA-: commit, explore, graphite, prepare, resume-work, review, pr-description (content), pr-fix-comments (content), pr-fix-gha\nB+: compress-prompt, debugging, implement, split-commit, start\nB: fix, git-surgeon, reference-sync\nF (discoverability): pr-description, pr-fix-comments (wrong filename)\n\n### Phases\n**Phase 1: Critical filename fixes**\nFiles: pr-description/skill.md, pr-fix-comments/skill.md\nTwo-step git mv for case-insensitive FS\n\n**Phase 2: Update writing-skills**\nFiles: writing-skills/SKILL.md\nAdd missing rules, fix description contradiction, add standard dirs\n\n**Phase 3: Fix broken skill references**\nFiles: debugging/SKILL.md, implement/SKILL.md\nRemove references to nonexistent skills (team-debug, tdd, verification-before-completion, finishing-branch) or create stubs\n\n**Phase 4: Description quality pass**\nFiles: compress-prompt, git-surgeon, graphite, reference-sync, implement SKILL.md\nAdd WHAT + WHEN + triggers to descriptions\n\n**Phase 5: Cleanup and normalization**\nFiles: pr-fix-gha, fix, multiple\nRemove redundant frontmatter, fix numbering, normalize allowed-tools syntax, add error handling\n\n**Phase 6: Progressive disclosure for long skills**\nFiles: review, pr-reviewers SKILL.md + new references/ dirs\nMove detailed prompts/algorithms to references/","status":"closed","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-13T22:02:50.653881-08:00","created_by":"Luan Santos","updated_at":"2026-02-13T22:34:06.850617-08:00","closed_at":"2026-02-13T22:34:06.850617-08:00","close_reason":"Closed"}
{"id":".claude-uxd","title":"Create rules/model-tiering.md documentation","description":"Create ~/.claude/rules/model-tiering.md documenting model tiering policy.\n\n## Content\n\n- Three tiers: Deep (opus), Standard (sonnet), Fast (haiku)\n- Skill assignments table\n- Effort level note (session-only via CLAUDE_CODE_EFFORT_LEVEL)\n- Escalation policy (sonnet fails → bump to opus)\n- CLAUDE_CODE_SUBAGENT_MODEL env var note\n\n## Acceptance Criteria\n- File exists at ~/.claude/rules/model-tiering.md\n- All three tiers documented with examples\n- Effort limitation clearly stated","status":"closed","priority":2,"issue_type":"task","assignee":"Luan Santos","owner":"github@luan.sh","created_at":"2026-02-09T19:49:13.119605-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:54:34.064998-08:00","closed_at":"2026-02-09T19:54:34.064998-08:00","close_reason":"Closed"}
{"id":".claude-wez","title":"test oneline bug","status":"tombstone","priority":4,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-09T19:25:24.081576-08:00","created_by":"Luan Santos","updated_at":"2026-02-09T19:28:07.580185-08:00","close_reason":"Closed","deleted_at":"2026-02-09T19:28:07.580185-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":".claude-wx7","title":"Review: parallel commit race fix","description":"## Acceptance Criteria\n- All changes reviewed for correctness and completeness\n- No contradictions between rule files\n- Prompt instructions clear and unambiguous for workers","design":"# Adversarial Review Summary\n\n## Critical\n| Severity | File:Line | Issue | Suggestion |\n|----------|-----------|-------|------------|\n| Critical | CLAUDE.md:75 vs worker-discipline.md:12-14 | Contradictory foreign-failure policy. CLAUDE.md says report+continue. New rule says message lead+wait. | Update CLAUDE.md:75 to match new policy. |\n\n## High\n| High | implement/SKILL.md:119-147 | Swarm worker prompt missing git prohibition. Solo has it, swarm does not. | Add never run git commands to swarm worker prompt. |\n| High | implement/SKILL.md:81,150 | Commit steps ambiguous about executor. | Annotate as orchestrator-only. |\n\n## Medium\n| Medium | implement/SKILL.md:81,150 | git add -u misses new untracked files. | Use git add . instead. |\n| Medium | implement/SKILL.md:81,150 | No empty-commit guard. | Add check before commit. |\n| Medium | implement/SKILL.md:55 | Step numbering gap (1,3,4,5). | Renumber. |\n\n## Low\n| Low | worker-discipline.md:23-24 | Double blank line. | Remove one. |\n| Low | implement/SKILL.md:187 | No replacement for removed merge serialization. | Add orchestrator-only commits to Key Rules. |\n| Low | session-completion.md:9 | main thread ambiguous. | Rephrase to orchestrator only. |\n\nVerdict: CHANGES REQUIRED - 1 Critical, 2 High, 3 Medium, 3 Low","status":"closed","priority":2,"issue_type":"task","owner":"github@luan.sh","created_at":"2026-02-14T11:46:41.764971-08:00","created_by":"Luan Santos","updated_at":"2026-02-14T11:51:32.352483-08:00","closed_at":"2026-02-14T11:51:32.352483-08:00","close_reason":"Closed"}
